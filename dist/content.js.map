{
  "version": 3,
  "sources": ["../js/config/constants.js", "../js/utils/language-detector.js", "../js/utils/word-filters.js", "../js/ui/wiktionary.js", "../js/ui/pronunciation.js", "../js/ui/tooltip.js", "../js/ui/toast.js", "../js/core/config.js", "../js/core/storage.js", "../js/services/cache-service.js", "../js/prompts/ai-prompts.js", "../js/utils/text-processor.js", "../js/services/api-service.js", "../js/services/content-segmenter.js", "../js/services/text-replacer.js", "../js/content.js"],
  "sourcesContent": ["/**\n * VocabMeld \u914D\u7F6E\u5E38\u91CF\n * \u96C6\u4E2D\u7BA1\u7406\u6240\u6709\u9B54\u6CD5\u6570\u5B57\u548C\u914D\u7F6E\u5E38\u91CF\n */\n\n/**\n * CEFR \u96BE\u5EA6\u7EA7\u522B\uFF08\u4ECE\u6613\u5230\u96BE\uFF09\n */\nexport const CEFR_LEVELS = ['A1', 'A2', 'B1', 'B2', 'C1', 'C2'];\n\n/**\n * \u66FF\u6362\u5F3A\u5EA6\u914D\u7F6E\n */\nexport const INTENSITY_CONFIG = {\n  low: { maxPerParagraph: 4 },\n  medium: { maxPerParagraph: 8 },\n  high: { maxPerParagraph: 14 }\n};\n\n/**\n * \u9700\u8981\u8DF3\u8FC7\u5904\u7406\u7684 HTML \u6807\u7B7E\n */\nexport const SKIP_TAGS = [\n  'SCRIPT',\n  'STYLE',\n  'NOSCRIPT',\n  'IFRAME',\n  'CODE',\n  'PRE',\n  'KBD',\n  'TEXTAREA',\n  'INPUT',\n  'SELECT',\n  'BUTTON'\n];\n\n/**\n * \u9700\u8981\u8DF3\u8FC7\u5904\u7406\u7684 CSS \u7C7B\u540D\n */\nexport const SKIP_CLASSES = [\n  'vocabmeld-translated',\n  'vocabmeld-tooltip',\n  'hljs',\n  'code',\n  'syntax'\n];\n\n/**\n * \u7F13\u5B58\u6700\u5927\u5BB9\u91CF\uFF08LRU\uFF09\n */\nexport const CACHE_MAX_SIZE = 2000;\n\n/**\n * \u82F1\u6587\u505C\u7528\u8BCD\u5217\u8868\uFF08\u7528\u4E8E\u8FC7\u6EE4\uFF09\n */\nexport const STOP_WORDS = new Set([\n  'the', 'a', 'an', 'is', 'are', 'was', 'were', 'be', 'been', 'being',\n  'have', 'has', 'had', 'do', 'does', 'did', 'will', 'would', 'could',\n  'should', 'may', 'might', 'must', 'shall', 'can', 'need', 'dare',\n  'ought', 'used', 'to', 'of', 'in', 'for', 'on', 'with', 'at', 'by',\n  'from', 'as', 'into', 'through', 'during', 'before', 'after', 'above',\n  'below', 'between', 'under', 'again', 'further', 'then', 'once',\n  'here', 'there', 'when', 'where', 'why', 'how', 'all', 'each', 'few',\n  'more', 'most', 'other', 'some', 'such', 'no', 'nor', 'not', 'only',\n  'own', 'same', 'so', 'than', 'too', 'very', 'just', 'and', 'but',\n  'if', 'or', 'because', 'until', 'while', 'this', 'that', 'these',\n  'those', 'what', 'which', 'who', 'whom', 'i', 'you', 'he', 'she',\n  'it', 'we', 'they', 'me', 'him', 'her', 'us', 'them', 'my', 'your',\n  'his', 'its', 'our', 'their'\n]);\n", "/**\n * VocabMeld \u8BED\u8A00\u68C0\u6D4B\u5DE5\u5177\n * \u63D0\u53D6\u81EA content.js\n */\n\nlet languageDetector = null;\n\n/**\n * \u521D\u59CB\u5316 Native LanguageDetector\uFF08\u5982\u679C\u53EF\u7528\uFF09\n */\nexport async function initLanguageDetector() {\n  try {\n    // \u68C0\u67E5\u6D4F\u89C8\u5668\u662F\u5426\u652F\u6301 LanguageDetector API\n    if (typeof LanguageDetector !== 'undefined' && LanguageDetector.create) {\n      languageDetector = await LanguageDetector.create({\n        expectedInputLanguages: ['en', 'zh', 'ja', 'ko', 'fr', 'de', 'es']\n      });\n      console.log('[VocabMeld] Native LanguageDetector initialized');\n    }\n  } catch (error) {\n    console.warn('[VocabMeld] LanguageDetector not available, using fallback:', error);\n    languageDetector = null;\n  }\n}\n\n/**\n * \u68C0\u6D4B\u6587\u672C\u8BED\u8A00\uFF08\u4F18\u5148\u4F7F\u7528 Native API\uFF0C\u964D\u7EA7\u5230\u6B63\u5219\u5339\u914D\uFF09\n * @param {string} text - \u8981\u68C0\u6D4B\u7684\u6587\u672C\n * @returns {Promise<string>|string} \u8BED\u8A00\u4EE3\u7801 (e.g., 'en', 'zh-CN', 'ja', 'ko')\n */\nexport async function detectLanguage(text) {\n  // \u5C1D\u8BD5\u4F7F\u7528 Native LanguageDetector\n  if (languageDetector) {\n    try {\n      const results = await languageDetector.detect(text);\n\n      // \u83B7\u53D6\u6700\u9AD8\u7F6E\u4FE1\u5EA6\u7684\u7ED3\u679C\uFF08\u6392\u9664 'und' - undetermined\uFF09\n      const validResults = results.filter(r => r.detectedLanguage !== 'und');\n\n      if (validResults.length > 0) {\n        const topResult = validResults[0];\n        let langCode = topResult.detectedLanguage;\n\n        // \u6807\u51C6\u5316\u8BED\u8A00\u4EE3\u7801\n        if (langCode.startsWith('zh')) {\n          langCode = 'zh-CN';\n        } else if (langCode.startsWith('ja')) {\n          langCode = 'ja';\n        } else if (langCode.startsWith('ko')) {\n          langCode = 'ko';\n        } else if (langCode.startsWith('en')) {\n          langCode = 'en';\n        }\n\n        return langCode;\n      }\n    } catch (error) {\n      console.warn('[VocabMeld] LanguageDetector error, using fallback:', error);\n      // \u964D\u7EA7\u5230 fallback\n    }\n  }\n\n  // Fallback: \u57FA\u4E8E\u6B63\u5219\u7684\u68C0\u6D4B\n  return detectLanguageFallback(text);\n}\n\n/**\n * \u57FA\u4E8E\u5B57\u7B26\u9891\u7387\u5206\u6790\u7684\u964D\u7EA7\u8BED\u8A00\u68C0\u6D4B\n * @param {string} text - \u8981\u68C0\u6D4B\u7684\u6587\u672C\n * @returns {string} \u8BED\u8A00\u4EE3\u7801\n */\nexport function detectLanguageFallback(text) {\n  const chineseRegex = /[\\u4e00-\\u9fff]/g;\n  const japaneseRegex = /[\\u3040-\\u309f\\u30a0-\\u30ff]/g;\n  const koreanRegex = /[\\uac00-\\ud7af]/g;\n  const latinRegex = /[a-zA-Z]/g;\n\n  const chineseCount = (text.match(chineseRegex) || []).length;\n  const japaneseCount = (text.match(japaneseRegex) || []).length;\n  const koreanCount = (text.match(koreanRegex) || []).length;\n  const latinCount = (text.match(latinRegex) || []).length;\n  const total = chineseCount + japaneseCount + koreanCount + latinCount || 1;\n\n  if (japaneseCount / total > 0.1) return 'ja';\n  if (koreanCount / total > 0.1) return 'ko';\n  if (chineseCount / total > 0.3) return 'zh-CN';\n  return 'en';\n}\n", "/**\n * VocabMeld \u5355\u8BCD\u8FC7\u6EE4\u5DE5\u5177\n * \u63D0\u53D6\u81EA content.js\n */\n\nimport { CEFR_LEVELS } from '../config/constants.js';\n\n/**\n * \u68C0\u67E5\u5355\u8BCD\u96BE\u5EA6\u662F\u5426\u517C\u5BB9\u7528\u6237\u8BBE\u7F6E\n * @param {string} wordDifficulty - \u5355\u8BCD\u96BE\u5EA6 (A1-C2)\n * @param {string} userDifficulty - \u7528\u6237\u96BE\u5EA6\u8BBE\u7F6E (A1-C2)\n * @returns {boolean} \u662F\u5426\u517C\u5BB9\uFF08\u5355\u8BCD\u96BE\u5EA6 >= \u7528\u6237\u96BE\u5EA6\uFF09\n */\nexport function isDifficultyCompatible(wordDifficulty, userDifficulty) {\n  const wordIdx = CEFR_LEVELS.indexOf(wordDifficulty);\n  const userIdx = CEFR_LEVELS.indexOf(userDifficulty);\n  return wordIdx >= userIdx;\n}\n\n/**\n * \u5224\u65AD\u662F\u5426\u4E3A\u5355\u4E2A\u82F1\u6587\u5355\u8BCD\n * @param {string} text - \u6587\u672C\n * @returns {boolean}\n */\nexport function isSingleEnglishWord(text) {\n  if (!text) return false;\n  const trimmed = text.trim();\n  return /^[a-zA-Z]+$/.test(trimmed);\n}\n\n/**\n * \u5224\u65AD\u662F\u5426\u53EF\u80FD\u662F\u4E13\u6709\u540D\u8BCD\n * @param {string} word - \u5355\u8BCD\n * @returns {boolean}\n */\nexport function isLikelyProperNoun(word) {\n  if (!word) return false;\n  const trimmed = word.trim();\n  if (!/^[A-Za-z][A-Za-z''-]*$/.test(trimmed)) return false;\n  if (trimmed === trimmed.toUpperCase()) return true; // \u7F29\u5199\u8BCD / \u5168\u5927\u5199\n  if (trimmed === trimmed.toLowerCase()) return false;\n  return /^[A-Z]/.test(trimmed);\n}\n\n/**\n * \u5224\u65AD\u662F\u5426\u4E3A\u975E\u5B66\u4E60\u8BCD\u6C47\uFF08URL\u3001\u6570\u5B57\u3001\u4E13\u6709\u540D\u8BCD\u7B49\uFF09\n * @param {string} word - \u5355\u8BCD\n * @returns {boolean}\n */\nexport function isNonLearningWord(word) {\n  if (!word) return true;\n  const trimmed = word.trim();\n  if (!trimmed) return true;\n  const lower = trimmed.toLowerCase();\n  if (/https?:\\/\\//i.test(trimmed) || /^www\\./i.test(trimmed)) return true;\n  if (/[0-9]/.test(trimmed)) return true;\n  if (/[#@]/.test(trimmed)) return true;\n  if (/[\\\\/]/.test(trimmed)) return true;\n  if (isLikelyProperNoun(trimmed)) return true;\n  // \u7981\u6B62\u660E\u663E\u7684\u57DF\u540D\u5F62\u5F0F\uFF08\u4F8B\u5982 example.com\uFF09\n  if (/\\.[a-z]{2,}$/.test(lower)) return true;\n  return false;\n}\n\n/**\n * \u5224\u65AD\u662F\u5426\u4E3A\u4EE3\u7801\u6587\u672C\n * @param {string} text - \u6587\u672C\n * @returns {boolean}\n */\nexport function isCodeText(text) {\n  const codePatterns = [\n    /^(const|let|var|function|class|import|export|return|if|else|for|while)\\s/,\n    /[{}();]\\s*$/,\n    /^\\s*(\\/\\/|\\/\\*|\\*|#)/,\n    /\\w+\\.\\w+\\(/,\n    /console\\./,\n    /https?:\\/\\//\n  ];\n  return codePatterns.some(pattern => pattern.test(text.trim()));\n}\n", "/**\n * VocabMeld Wiktionary \u8BCD\u5178\u96C6\u6210\n * \u63D0\u53D6\u81EA content.js\n */\n\n// \u8BCD\u5178\u7F13\u5B58\nconst dictionaryCache = new Map();\n\n// \u6301\u4E45\u5316\u7F13\u5B58\uFF08\u8DE8\u9875\u9762\u5237\u65B0\u751F\u6548\uFF09\nconst PERSISTENT_CACHE_STORAGE_KEY = 'vocabmeld_wiktionary_cache';\nconst PERSISTENT_CACHE_MAX_SIZE = 800;\nlet persistentCache = null; // Map<cacheKey, { value: object|null, cachedAt: number }>\nlet persistentCacheInitPromise = null;\nlet persistTimer = null;\n\nfunction canUseChromeStorage() {\n  try {\n    return !!(globalThis.chrome?.storage?.local?.get && globalThis.chrome?.storage?.local?.set);\n  } catch {\n    return false;\n  }\n}\n\nasync function ensurePersistentCacheLoaded() {\n  if (!canUseChromeStorage()) {\n    if (!persistentCache) persistentCache = new Map();\n    return;\n  }\n\n  if (persistentCache) return;\n  if (persistentCacheInitPromise) return persistentCacheInitPromise;\n\n  persistentCacheInitPromise = new Promise((resolve) => {\n    chrome.storage.local.get(PERSISTENT_CACHE_STORAGE_KEY, (result) => {\n      const raw = result?.[PERSISTENT_CACHE_STORAGE_KEY];\n      const map = new Map();\n\n      if (Array.isArray(raw)) {\n        for (const item of raw) {\n          const key = item?.key;\n          if (typeof key !== 'string' || !key) continue;\n          map.set(key, { value: item?.value ?? null, cachedAt: Number(item?.cachedAt) || 0 });\n        }\n      }\n\n      // \u9632\u5FA1\u6027\u88C1\u526A\n      while (map.size > PERSISTENT_CACHE_MAX_SIZE) {\n        const firstKey = map.keys().next().value;\n        map.delete(firstKey);\n      }\n\n      persistentCache = map;\n      resolve();\n    });\n  });\n\n  return persistentCacheInitPromise;\n}\n\nfunction schedulePersistPersistentCache() {\n  if (!canUseChromeStorage() || !persistentCache) return;\n\n  if (persistTimer) clearTimeout(persistTimer);\n  persistTimer = setTimeout(() => {\n    persistTimer = null;\n    try {\n      const data = [];\n      for (const [key, meta] of persistentCache) {\n        data.push({ key, value: meta?.value ?? null, cachedAt: Number(meta?.cachedAt) || 0 });\n      }\n      chrome.storage.local.set({ [PERSISTENT_CACHE_STORAGE_KEY]: data }, () => {});\n    } catch {\n      // ignore\n    }\n  }, 400);\n}\n\nasync function getPersistentCacheValue(cacheKey) {\n  await ensurePersistentCacheLoaded();\n  if (!persistentCache?.has(cacheKey)) return undefined;\n\n  const meta = persistentCache.get(cacheKey);\n  // \u8F7B\u91CF LRU\uFF1A\u89E6\u78B0\u540E\u79FB\u52A8\u5230\u672B\u5C3E\uFF08\u4E0D\u5F3A\u5236\u6301\u4E45\u5316\uFF09\n  persistentCache.delete(cacheKey);\n  persistentCache.set(cacheKey, meta);\n  return meta?.value ?? null;\n}\n\nasync function setPersistentCacheValue(cacheKey, value) {\n  await ensurePersistentCacheLoaded();\n  if (!persistentCache) persistentCache = new Map();\n\n  if (persistentCache.has(cacheKey)) persistentCache.delete(cacheKey);\n  while (persistentCache.size >= PERSISTENT_CACHE_MAX_SIZE) {\n    const firstKey = persistentCache.keys().next().value;\n    persistentCache.delete(firstKey);\n  }\n  persistentCache.set(cacheKey, { value: value ?? null, cachedAt: Date.now() });\n  schedulePersistPersistentCache();\n}\n\nfunction normalizeKey(word) {\n  return (word || '').toLowerCase().trim();\n}\n\nfunction normalizeWikiUrl(url, langCode) {\n  if (!url) return '';\n  if (url.startsWith('//')) return `https:${url}`;\n  if (url.startsWith('/')) return `https://${langCode}.wiktionary.org${url}`;\n  return url;\n}\n\nfunction tryExtractFileTitleFromUrl(url, langCode) {\n  try {\n    const normalized = normalizeWikiUrl(url, langCode);\n    const u = new URL(normalized);\n\n    // /wiki/File:Something.ogg\n    if (u.pathname.startsWith('/wiki/')) {\n      const rest = u.pathname.slice('/wiki/'.length);\n      if (rest.startsWith('File:')) {\n        return decodeURIComponent(rest);\n      }\n    }\n\n    // /w/index.php?title=File:Something.ogg\n    const title = u.searchParams.get('title');\n    if (title && title.startsWith('File:')) return title;\n\n    return '';\n  } catch {\n    return '';\n  }\n}\n\nfunction fileTitleToSpecialFilePathUrl(fileTitle, langCode) {\n  if (!fileTitle) return '';\n  // MediaWiki: Special:FilePath expects a filename (without \"File:\" prefix).\n  const filename = String(fileTitle).replace(/^File:/i, '').trim();\n  if (!filename) return '';\n  return `https://${langCode}.wiktionary.org/wiki/Special:FilePath/${encodeURIComponent(filename)}`;\n}\n\nfunction getLanguageScopeRoot(doc, langCode) {\n  const contentRoot = doc.querySelector('.mw-parser-output') || doc.body;\n\n  // \u76EE\u524D\u4E3B\u8981\u7528\u4E8E\u82F1\u8BED\uFF1A\u4F18\u5148\u53EA\u5728 English \u8BED\u8A00\u6BB5\u843D\u91CC\u63D0\u53D6\u53D1\u97F3/\u97F3\u9891\uFF0C\u907F\u514D\u6293\u5230\u5176\u5B83\u8BED\u8A00\u3002\n  const langId = langCode === 'en' ? 'English' : '';\n  if (!langId) return contentRoot;\n\n  const heading = contentRoot.querySelector(`h2#${CSS.escape(langId)}`);\n  const headingContainer = heading?.closest?.('.mw-heading');\n  if (!headingContainer) return contentRoot;\n\n  const scope = doc.createElement('div');\n  let node = headingContainer;\n  while (node && node.nextElementSibling) {\n    node = node.nextElementSibling;\n    if (node.classList?.contains('mw-heading2')) break;\n    scope.appendChild(node.cloneNode(true));\n  }\n  return scope.childElementCount ? scope : contentRoot;\n}\n\nfunction extractFormOfTargetWord(scopeRoot) {\n  const link =\n    scopeRoot.querySelector('.form-of-definition .form-of-definition-link a[href]') ||\n    scopeRoot.querySelector('.form-of-definition-link a[href]');\n\n  if (!link) return '';\n\n  const title = (link.getAttribute('title') || '').replace(/#.*/, '').trim();\n  if (title) return title;\n\n  const href = link.getAttribute('href') || '';\n  const match = href.match(/\\/wiki\\/([^#?]+)/);\n  if (!match) return '';\n\n  try {\n    return decodeURIComponent(match[1]).replace(/_/g, ' ').trim();\n  } catch {\n    return match[1].replace(/_/g, ' ').trim();\n  }\n}\n\nfunction extractAudioCandidateUrls(scopeRoot, langCode) {\n  const urls = [];\n  const push = (raw) => {\n    const normalized = normalizeWikiUrl(raw, langCode);\n    if (normalized) urls.push(normalized);\n  };\n\n  // MediaWiki \u53EF\u80FD\u7528 <audio src> \u6216 <audio><source src>\n  scopeRoot.querySelectorAll('audio source[src]').forEach((el) => push(el.getAttribute('src')));\n  scopeRoot.querySelectorAll('audio[src]').forEach((el) => push(el.getAttribute('src')));\n\n  // \u6709\u4E9B\u9875\u9762\u53EF\u80FD\u53EA\u7ED9 File: \u94FE\u63A5\uFF08\u4F5C\u4E3A\u964D\u7EA7\uFF09\n  scopeRoot\n    .querySelectorAll('a[href^=\"/wiki/File:\"], a[href*=\"title=File:\"]')\n    .forEach((el) => push(el.getAttribute('href')));\n\n  // \u53BB\u91CD\n  return [...new Set(urls)];\n}\n\nfunction scoreAudioUrl(url) {\n  const u = String(url || '');\n  let score = 0;\n  if (u.includes('upload.wikimedia.org')) score += 50;\n  if (u.includes('Special:FilePath')) score += 40;\n  if (/\\.(mp3)(\\?|$)/i.test(u)) score += 20;\n  if (/\\.(ogg|oga)(\\?|$)/i.test(u)) score += 18;\n  if (/\\.(wav)(\\?|$)/i.test(u)) score += 10;\n  if (u.includes('/wiki/File:') || u.includes('title=File:')) score -= 30; // \u6587\u4EF6\u9875\u901A\u5E38\u4E0D\u662F\u53EF\u64AD\u653E\u97F3\u9891\n  return score;\n}\n\nasync function resolveAudioUrls(candidateUrls, langCode) {\n  const ranked = [...candidateUrls].sort((a, b) => scoreAudioUrl(b) - scoreAudioUrl(a));\n  const resolved = [];\n\n  // \u9650\u5236\u89E3\u6790\u6570\u91CF\uFF0C\u907F\u514D\u8FC7\u591A\u8BF7\u6C42\n  for (const url of ranked.slice(0, 4)) {\n    if (url.includes('upload.wikimedia.org') || url.includes('Special:FilePath')) {\n      resolved.push(url);\n      continue;\n    }\n\n    const fileTitle = tryExtractFileTitleFromUrl(url, langCode);\n    if (fileTitle) {\n      const filePathUrl = fileTitleToSpecialFilePathUrl(fileTitle, langCode);\n      if (filePathUrl) resolved.push(filePathUrl);\n    }\n  }\n\n  return [...new Set(resolved)];\n}\n\n/**\n * \u4ECE Wiktionary \u83B7\u53D6\u8BCD\u5178\u6761\u76EE\n * @param {string} word - \u5355\u8BCD\n * @param {string} langCode - \u8BED\u8A00\u4EE3\u7801 (default: 'en')\n * @returns {Promise<object|null>} \u8BCD\u5178\u6761\u76EE\u6216 null\n */\nexport async function getDictionaryEntry(word, langCode = 'en') {\n  return await getDictionaryEntryInternal(word, langCode, 0, new Set());\n}\n\nasync function getDictionaryEntryInternal(word, langCode, depth, visited) {\n  const key = normalizeKey(word);\n  if (!key) return null;\n\n  const cacheKey = `${key}_${langCode}`;\n  const cached = dictionaryCache.get(cacheKey);\n  if (cached !== undefined) return cached;\n\n  // \u8BFB\u53D6\u8DE8\u5237\u65B0\u6301\u4E45\u5316\u7F13\u5B58\n  const persisted = await getPersistentCacheValue(cacheKey);\n  if (persisted !== undefined) {\n    dictionaryCache.set(cacheKey, persisted);\n    return persisted;\n  }\n\n  if (visited.has(cacheKey)) return null;\n  visited.add(cacheKey);\n\n  // \u521D\u59CB\u5316\u8FD4\u56DE\u7ED3\u6784\n  const entry = {\n    audioUrl: '',\n    audioUrls: [],\n    phoneticText: '',\n    shortDefinition: '',\n    partOfSpeech: '',\n    example: ''\n  };\n\n  try {\n    // \u6784\u5EFA Parse API URL (origin=* \u89E3\u51B3 CORS)\n    const url = `https://${langCode}.wiktionary.org/w/api.php?action=parse&page=${encodeURIComponent(word)}&format=json&prop=text&origin=*`;\n\n    const response = await fetch(url);\n    const data = await response.json();\n\n    // \u68C0\u67E5\u9519\u8BEF\u6216\u7F3A\u5931\u9875\u9762\n    if (data.error || !data.parse || !data.parse.text) {\n      console.warn(`[VocabMeld] Word not found: ${word}`);\n      dictionaryCache.set(cacheKey, null);\n      await setPersistentCacheValue(cacheKey, null);\n      return null;\n    }\n\n    // \u89E3\u6790 HTML \u5185\u5BB9\n    const htmlString = data.parse.text['*'];\n    const parser = new DOMParser();\n    const doc = parser.parseFromString(htmlString, 'text/html');\n\n    const scopeRoot = getLanguageScopeRoot(doc, langCode);\n\n    // A. \u63D0\u53D6\u8BCD\u6027\n    const validPOS = ['Noun', 'Verb', 'Adjective', 'Adverb', 'Interjection', 'Pronoun', 'Preposition', 'Conjunction'];\n    let posHeader = null;\n\n    const headers = scopeRoot.querySelectorAll('h3, h4');\n    for (const header of headers) {\n      const text = header.textContent.replace(/\\[.*?\\]/g, '').trim();\n      if (validPOS.some(pos => text.includes(pos))) {\n        entry.partOfSpeech = text;\n        posHeader = header;\n        break;\n      }\n    }\n\n    // B. \u63D0\u53D6\u97F3\u6807 (IPA)\n    const phoneticEl = scopeRoot.querySelector('.IPA');\n    if (phoneticEl) entry.phoneticText = phoneticEl.textContent.trim();\n\n    // C. \u63D0\u53D6\u97F3\u9891\uFF08\u652F\u6301 mp3/ogg/wav\uFF1B\u5E76\u5C3D\u91CF\u89E3\u6790\u6210\u53EF\u76F4\u63A5\u64AD\u653E\u7684 upload.wikimedia URL\uFF09\n    const audioCandidates = extractAudioCandidateUrls(scopeRoot, langCode);\n    entry.audioUrls = await resolveAudioUrls(audioCandidates, langCode);\n    entry.audioUrl = entry.audioUrls[0] || '';\n\n    // D. \u63D0\u53D6\u5B9A\u4E49\u548C\u4F8B\u53E5\n    if (posHeader) {\n      let currentNode = posHeader.parentNode;\n      if (!currentNode.classList.contains('mw-heading')) {\n        currentNode = posHeader;\n      }\n\n      let definitionList = null;\n      while (currentNode && currentNode.nextElementSibling) {\n        currentNode = currentNode.nextElementSibling;\n        if (currentNode.tagName === 'OL') {\n          definitionList = currentNode;\n          break;\n        }\n        if (['H2', 'H3'].includes(currentNode.tagName)) break;\n      }\n\n      if (definitionList) {\n        const firstLi = definitionList.querySelector('li');\n        if (firstLi) {\n          const exampleEl = firstLi.querySelector('.h-usage-example, .e-example, .use-with-mention + dl, .h-usage-example');\n          if (exampleEl) entry.example = exampleEl.textContent.trim().slice(0, 150);\n\n          const cloneLi = firstLi.cloneNode(true);\n          const removeSelectors = ['.h-usage-example', '.e-example', 'ul', 'dl', '.reference'];\n          removeSelectors.forEach(sel => {\n            cloneLi.querySelectorAll(sel).forEach(el => el.remove());\n          });\n          entry.shortDefinition = cloneLi.textContent.trim().slice(0, 220);\n        }\n      }\n    }\n\n    // E. \u201CAlternative form/spelling of \u2026\u201D \u7B49\u9875\u9762\u901A\u5E38\u6CA1\u6709\u53D1\u97F3\uFF0C\u5C1D\u8BD5\u8FFD\u6EAF\u5230\u76EE\u6807\u8BCD\u6761\n    if (depth < 1 && (!entry.audioUrl || !entry.phoneticText)) {\n      const target = extractFormOfTargetWord(scopeRoot);\n      if (target && normalizeKey(target) !== key) {\n        const derived = await getDictionaryEntryInternal(target, langCode, depth + 1, visited);\n        if (derived) {\n          if (!entry.phoneticText) entry.phoneticText = derived.phoneticText || '';\n          if (!entry.partOfSpeech) entry.partOfSpeech = derived.partOfSpeech || '';\n          if (!entry.shortDefinition) entry.shortDefinition = derived.shortDefinition || '';\n          if (!entry.example) entry.example = derived.example || '';\n          if (!entry.audioUrl) {\n            entry.audioUrls = derived.audioUrls || (derived.audioUrl ? [derived.audioUrl] : []);\n            entry.audioUrl = entry.audioUrls[0] || derived.audioUrl || '';\n          }\n        }\n      }\n    }\n\n    dictionaryCache.set(cacheKey, entry);\n    await setPersistentCacheValue(cacheKey, entry);\n    return entry;\n  } catch (error) {\n    console.error('[VocabMeld] Dictionary lookup error:', error);\n    dictionaryCache.set(cacheKey, null);\n    await setPersistentCacheValue(cacheKey, null);\n    return null;\n  }\n}\n\n/**\n * \u64AD\u653E\u8BCD\u5178\u97F3\u9891\n * @param {string} word - \u5355\u8BCD\n * @param {string} langCode - \u8BED\u8A00\u4EE3\u7801\n * @returns {Promise<void>}\n */\nexport async function playDictionaryAudio(word, langCode = 'en') {\n  try {\n    const entry = await getDictionaryEntry(word, langCode);\n    const urls = entry?.audioUrls?.length ? entry.audioUrls : entry?.audioUrl ? [entry.audioUrl] : [];\n    if (!urls.length) {\n      throw new Error('No audio');\n    }\n\n    const result = await chrome.runtime.sendMessage({ action: 'playAudioUrls', urls }).catch((e) => {\n      throw e;\n    });\n\n    if (result?.success) return;\n    throw new Error(result?.message || 'Audio play failed');\n  } catch (error) {\n    console.warn('[VocabMeld] Dictionary audio failed:', error);\n    throw error;\n  }\n}\n", "/**\n * VocabMeld \u53D1\u97F3\u97F3\u9891\u6E90\n */\n\nfunction normalizeYoudaoType(type) {\n  return Number(type) === 1 ? 1 : 2;\n}\n\nexport function buildYoudaoDictVoiceUrl(word, type = 2) {\n  const audio = String(word || '').trim();\n  if (!audio) return '';\n  const t = normalizeYoudaoType(type);\n  return `https://dict.youdao.com/dictvoice?audio=${encodeURIComponent(audio)}&type=${t}`;\n}\n\nfunction toGoogleTtsLangCode(lang) {\n  const code = String(lang || '').trim();\n  if (!code) return 'en';\n\n  const map = {\n    en: 'en',\n    ja: 'ja',\n    ko: 'ko',\n    fr: 'fr',\n    de: 'de',\n    es: 'es',\n    ru: 'ru',\n    'zh-CN': 'zh',\n    'zh-TW': 'zh'\n  };\n\n  if (map[code]) return map[code];\n  const primary = code.split('-')[0];\n  return map[primary] || primary || 'en';\n}\n\nexport function buildGoogleTranslateTtsUrl(text, lang) {\n  const q = String(text || '').trim();\n  if (!q) return '';\n  const tl = toGoogleTtsLangCode(lang);\n  return `https://translate.google.com/translate_tts?ie=UTF-8&q=${encodeURIComponent(q)}&tl=${encodeURIComponent(tl)}&client=tw-ob`;\n}\n\nexport async function playAudioUrls(urls) {\n  const list = Array.isArray(urls) ? urls.filter(Boolean) : [];\n  if (!list.length) throw new Error('No audio URLs');\n\n  const result = await chrome.runtime.sendMessage({ action: 'playAudioUrls', urls: list }).catch((e) => {\n    throw e;\n  });\n\n  if (result?.success) return;\n  throw new Error(result?.message || 'Audio play failed');\n}\n\nexport async function playYoudaoDictVoice(word, type = 2) {\n  const primaryType = normalizeYoudaoType(type);\n  const secondaryType = primaryType === 1 ? 2 : 1;\n\n  const primaryUrl = buildYoudaoDictVoiceUrl(word, primaryType);\n  const secondaryUrl = buildYoudaoDictVoiceUrl(word, secondaryType);\n\n  await playAudioUrls([primaryUrl, secondaryUrl]);\n}\n\nexport async function playGoogleTranslateTts(text, lang) {\n  const url = buildGoogleTranslateTtsUrl(text, lang);\n  await playAudioUrls([url]);\n}\n", "/**\n * VocabMeld Tooltip \u7BA1\u7406\u5668\n * \u63D0\u53D6\u81EA content.js\n */\n\nimport { getDictionaryEntry, playDictionaryAudio } from './wiktionary.js';\nimport { playGoogleTranslateTts, playYoudaoDictVoice } from './pronunciation.js';\nimport { detectLanguage } from '../utils/language-detector.js';\nimport { isSingleEnglishWord } from '../utils/word-filters.js';\n\n/**\n * Tooltip \u7BA1\u7406\u7C7B\n */\nexport class TooltipManager {\n  constructor() {\n    this.tooltip = null;\n    this.currentTooltipElement = null;\n    this.tooltipHideTimeout = null;\n    this.config = null;\n  }\n\n  escapeHtml(value) {\n    return String(value ?? '')\n      .replace(/&/g, '&amp;')\n      .replace(/</g, '&lt;')\n      .replace(/>/g, '&gt;')\n      .replace(/\"/g, '&quot;')\n      .replace(/'/g, '&#39;');\n  }\n\n  /**\n   * \u8BBE\u7F6E\u914D\u7F6E\n   * @param {object} config - \u914D\u7F6E\u5BF9\u8C61\n   */\n  setConfig(config) {\n    this.config = config;\n  }\n\n  /**\n   * \u521B\u5EFA Tooltip \u5143\u7D20\n   */\n  createTooltip() {\n    if (this.tooltip) return;\n\n    this.tooltip = document.createElement('div');\n    this.tooltip.className = 'vocabmeld-tooltip';\n    this.tooltip.style.display = 'none';\n    document.body.appendChild(this.tooltip);\n  }\n\n  /**\n   * \u663E\u793A Tooltip\n   * @param {HTMLElement} element - \u7FFB\u8BD1\u5143\u7D20\n   */\n  async show(element) {\n    if (!this.tooltip || !element.classList?.contains('vocabmeld-translated')) return;\n\n    // \u53D6\u6D88\u5F85\u5904\u7406\u7684\u9690\u85CF\u64CD\u4F5C\n    if (this.tooltipHideTimeout) {\n      clearTimeout(this.tooltipHideTimeout);\n      this.tooltipHideTimeout = null;\n    }\n\n    this.currentTooltipElement = element;\n    const original = element.getAttribute('data-original') || '';\n    const translation = element.getAttribute('data-translation') || '';\n    const aiPhonetic = element.getAttribute('data-phonetic') || '';\n    const difficulty = element.getAttribute('data-difficulty') || '';\n    const aiPartOfSpeech = element.getAttribute('data-part-of-speech') || '';\n    const aiShortDefinition = element.getAttribute('data-short-definition') || '';\n    const sourceLang = element.getAttribute('data-source-lang') || '';\n    const aiExample = element.getAttribute('data-example') || '';\n\n    // \u83B7\u53D6\u5B66\u4E60\u8BED\u8A00\n    const learningLanguage = this.config?.targetLanguage || 'en';\n\n    // \u5224\u65AD\u5B66\u4E60\u8BED\u8A00\u7684\u8BCD\u6C47\u5728\u54EA\u4E2A\u5B57\u6BB5\n    // \u4F18\u5148\u4F7F\u7528 sourceLang\uFF1BsourceLang \u4E3A\u7A7A\u65F6\u7528\u542F\u53D1\u5F0F/\u68C0\u6D4B\u964D\u7EA7\n    let isLearningFromOriginal;\n    if (sourceLang) {\n      isLearningFromOriginal = sourceLang === learningLanguage;\n    } else if (learningLanguage === 'en') {\n      if (isSingleEnglishWord(original)) isLearningFromOriginal = true;\n      else if (isSingleEnglishWord(translation)) isLearningFromOriginal = false;\n    }\n\n    if (typeof isLearningFromOriginal !== 'boolean') {\n      const originalLang = original ? await detectLanguage(original) : '';\n      isLearningFromOriginal = originalLang === learningLanguage;\n    }\n\n    const learningWord = (isLearningFromOriginal ? original : translation) || '';\n    const nativeTranslation = (isLearningFromOriginal ? translation : original) || '';\n\n    // \u5B57\u5178\u67E5\u8BE2\uFF1A\u4EC5\u5BF9\u5B66\u4E60\u8BED\u8A00\u4E3A\u82F1\u8BED\u7684\u5355\u8BCD\u505A Wiktionary \u67E5\u8BE2\n    const hasDictionaryWord = learningLanguage === 'en' && isSingleEnglishWord(learningWord);\n    const dictionaryWord = hasDictionaryWord ? learningWord.trim() : '';\n    const dictionaryLang = hasDictionaryWord ? 'en' : '';\n\n    // \u5148\u7528 AI \u6570\u636E\u6E32\u67D3\u521D\u59CB\u5185\u5BB9\n    this.renderTooltipContent({\n      learningWord,\n      nativeTranslation,\n      difficulty,\n      phonetic: aiPhonetic,\n      originalWord: original,\n      partOfSpeech: aiPartOfSpeech,\n      shortDefinition: aiShortDefinition,\n      wiktionaryExample: null,\n      aiExample,\n      isLoading: hasDictionaryWord\n    });\n\n    // \u5B9A\u4F4D tooltip\n    const rect = element.getBoundingClientRect();\n    this.tooltip.style.left = rect.left + window.scrollX + 'px';\n    this.tooltip.style.top = rect.bottom + window.scrollY + 5 + 'px';\n    this.tooltip.style.display = 'block';\n\n    // \u5982\u679C\u6709\u5B57\u5178\u8BCD\uFF0C\u5F02\u6B65\u83B7\u53D6 Wiktionary \u6570\u636E\u5E76\u66F4\u65B0\n    if (hasDictionaryWord) {\n      const key = dictionaryWord.toLowerCase().trim();\n      this.tooltip.dataset.dictWord = key;\n\n      try {\n        const entry = await getDictionaryEntry(dictionaryWord, dictionaryLang);\n\n        // \u68C0\u67E5\u662F\u5426\u4ECD\u7136\u662F\u540C\u4E00\u4E2A\u8BCD\n        if (this.tooltip.dataset.dictWord !== key) return;\n\n        // \u4F7F\u7528 Wiktionary \u6570\u636E\u4F18\u5148\uFF08\u82F1\u8BED\u5B66\u4E60\u65F6\u66F4\u53EF\u9760\uFF09\uFF0CAI \u4E3A\u5907\u9009\n        const finalPhonetic = entry?.phoneticText || aiPhonetic;\n        const finalPartOfSpeech = entry?.partOfSpeech || aiPartOfSpeech;\n\n        let finalDefinition = entry?.shortDefinition || aiShortDefinition;\n        if (finalDefinition) {\n          finalDefinition = finalDefinition\n            .replace(/\\([^)]*[\\/\\[][^\\]\\/]*[\\/\\]][^)]*\\)/g, '')\n            .replace(/[\\/\\[][^\\]\\/]+[\\/\\]]/g, '')\n            .replace(/\\s+/g, ' ')\n            .trim();\n        }\n\n        this.renderTooltipContent({\n          learningWord,\n          nativeTranslation,\n          difficulty,\n          phonetic: finalPhonetic,\n          originalWord: original,\n          partOfSpeech: finalPartOfSpeech,\n          shortDefinition: finalDefinition,\n          wiktionaryExample: entry?.example || null,\n          aiExample,\n          isLoading: false\n        });\n      } catch (error) {\n        // Wiktionary \u5931\u8D25\uFF0C\u4FDD\u6301 AI \u6570\u636E\n        if (this.tooltip.dataset.dictWord === key) {\n          this.renderTooltipContent({\n            learningWord,\n            nativeTranslation,\n            difficulty,\n            phonetic: aiPhonetic,\n            originalWord: original,\n            partOfSpeech: aiPartOfSpeech,\n            shortDefinition: aiShortDefinition,\n            wiktionaryExample: null,\n            aiExample,\n            isLoading: false\n          });\n        }\n      }\n    }\n  }\n\n  /**\n   * \u6E32\u67D3 Tooltip \u5185\u5BB9\n   * @param {object} data - \u6E32\u67D3\u6570\u636E\n   */\n  renderTooltipContent({ learningWord, nativeTranslation, difficulty, phonetic, originalWord, partOfSpeech, shortDefinition, wiktionaryExample, aiExample, isLoading }) {\n    const safeLearningWord = this.escapeHtml(learningWord);\n    const safeNativeTranslation = this.escapeHtml(nativeTranslation);\n    const safePhonetic = this.escapeHtml(phonetic);\n    const safeOriginalWord = this.escapeHtml(originalWord);\n    const safePartOfSpeech = this.escapeHtml(partOfSpeech);\n    const safeShortDefinition = this.escapeHtml(shortDefinition);\n    const safeDifficulty = this.escapeHtml(difficulty);\n\n    const safePhoneticHtml = safePhonetic\n      ? `<div class=\"vocabmeld-tooltip-phonetic\">${safePhonetic}</div>`\n      : '';\n\n    const safePosHtml = safePartOfSpeech\n      ? `<span class=\"vocabmeld-tooltip-pos\">${safePartOfSpeech}</span>`\n      : '';\n\n    const safeDefinitionHtml = safeShortDefinition\n      ? `<div class=\"vocabmeld-tooltip-definition\">${safePosHtml}${safeShortDefinition}</div>`\n      : '';\n\n    let safeExamplesHtml = '';\n    const examples = [];\n    const safeWiktionaryExample = this.escapeHtml(wiktionaryExample);\n    const safeAiExample = this.escapeHtml(aiExample);\n\n    if (safeWiktionaryExample) {\n      examples.push(`<div class=\"vocabmeld-tooltip-example\">${safeWiktionaryExample}</div>`);\n    }\n\n    if (safeAiExample) {\n      const alreadyMarked = /\\(AI\\)\\s*$/.test(String(aiExample || ''));\n      examples.push(`<div class=\"vocabmeld-tooltip-example\">${safeAiExample}${alreadyMarked ? '' : ' (AI)'}</div>`);\n    }\n\n    if (isLoading) {\n      safeExamplesHtml = `<div class=\"vocabmeld-tooltip-examples\">${examples.join('')}<div class=\"vocabmeld-tooltip-dict-loading\">Loading...</div></div>`;\n    } else if (examples.length > 0) {\n      safeExamplesHtml = `<div class=\"vocabmeld-tooltip-examples\">${examples.join('')}</div>`;\n    }\n\n    this.tooltip.innerHTML = `\n      <div class=\"vocabmeld-tooltip-header\">\n        <span class=\"vocabmeld-tooltip-word\">${safeLearningWord}${safeNativeTranslation ? ` <span class=\"vocabmeld-tooltip-translation\">(${safeNativeTranslation})</span>` : ''}</span>\n        ${safeDifficulty ? `<span class=\"vocabmeld-tooltip-badge\">${safeDifficulty}</span>` : ''}\n      </div>\n      ${safePhoneticHtml}\n      <div class=\"vocabmeld-tooltip-original\">Original: ${safeOriginalWord}</div>\n      ${safeDefinitionHtml}\n      ${safeExamplesHtml}\n      <div class=\"vocabmeld-tooltip-actions\">\n        <button class=\"vocabmeld-action-btn vocabmeld-btn-speak\" data-action=\"speak\" title=\"Pronounce\">\n          <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n            <polygon points=\"11 5 6 9 2 9 2 15 6 15 11 19 11 5\"></polygon>\n            <path d=\"M15.54 8.46a5 5 0 0 1 0 7.07\"></path>\n            <path d=\"M19.07 4.93a10 10 0 0 1 0 14.14\"></path>\n          </svg>\n          <span>\u53D1\u97F3</span>\n        </button>\n        <button class=\"vocabmeld-action-btn vocabmeld-btn-memorize\" data-action=\"memorize\" title=\"Add to memorize list\">\n          <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n            <path d=\"M12 5v14M5 12h14\"></path>\n          </svg>\n          <span>\u8BB0\u5FC6</span>\n        </button>\n        <button class=\"vocabmeld-action-btn vocabmeld-btn-learned\" data-action=\"learned\" title=\"\u6807\u8BB0\u4E3A\u5DF2\u5B66\u4F1A\">\n          <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n            <polyline points=\"20 6 9 17 4 12\"></polyline>\n          </svg>\n          <span>\u5DF2\u5B66\u4F1A</span>\n        </button>\n      </div>\n    `;\n  }\n\n  /**\n   * \u9690\u85CF Tooltip\n   * @param {boolean} immediate - \u662F\u5426\u7ACB\u5373\u9690\u85CF\n   */\n  hide(immediate = false) {\n    if (this.tooltipHideTimeout) {\n      clearTimeout(this.tooltipHideTimeout);\n      this.tooltipHideTimeout = null;\n    }\n\n    if (immediate) {\n      if (this.tooltip) this.tooltip.style.display = 'none';\n      this.currentTooltipElement = null;\n    } else {\n      // \u5EF6\u8FDF\u9690\u85CF\uFF0C\u7ED9\u7528\u6237\u65F6\u95F4\u79FB\u52A8\u5230 tooltip\n      this.tooltipHideTimeout = setTimeout(() => {\n        if (this.tooltip) this.tooltip.style.display = 'none';\n        this.currentTooltipElement = null;\n        this.tooltipHideTimeout = null;\n      }, 800);\n    }\n  }\n\n  /**\n   * \u53D6\u6D88 Tooltip \u9690\u85CF\u64CD\u4F5C\n   */\n  cancelHide() {\n    if (this.tooltipHideTimeout) {\n      clearTimeout(this.tooltipHideTimeout);\n      this.tooltipHideTimeout = null;\n    }\n  }\n\n  /**\n   * \u83B7\u53D6\u5F53\u524D Tooltip \u5BF9\u5E94\u7684\u5143\u7D20\n   * @returns {HTMLElement|null}\n   */\n  getCurrentElement() {\n    return this.currentTooltipElement;\n  }\n\n  /**\n   * \u64AD\u653E\u5355\u8BCD\u97F3\u9891\n   * @param {HTMLElement} element - \u7FFB\u8BD1\u5143\u7D20\n   */\n  async playAudio(element) {\n    if (!element) return;\n\n    const original = element.getAttribute('data-original') || '';\n    const translation = element.getAttribute('data-translation') || '';\n    const sourceLang = element.getAttribute('data-source-lang') || '';\n\n    // \u83B7\u53D6\u5B66\u4E60\u8BED\u8A00\n    const learningLanguage = this.config?.targetLanguage || 'en';\n\n    let isLearningFromOriginal;\n    if (sourceLang) {\n      isLearningFromOriginal = sourceLang === learningLanguage;\n    } else if (learningLanguage === 'en') {\n      if (isSingleEnglishWord(original)) isLearningFromOriginal = true;\n      else if (isSingleEnglishWord(translation)) isLearningFromOriginal = false;\n    }\n\n    if (typeof isLearningFromOriginal !== 'boolean') {\n      const originalLang = original ? await detectLanguage(original) : '';\n      isLearningFromOriginal = originalLang === learningLanguage;\n    }\n\n    const learningWord = (isLearningFromOriginal ? original : translation) || '';\n\n    // \u786E\u5B9A\u8981\u64AD\u653E\u7684\u8BCD\u548C\u8BED\u8A00\n    let word = learningWord;\n    let lang = learningLanguage;\n\n    if (!word) {\n      // \u964D\u7EA7\u5904\u7406\n      word = translation || original;\n      lang = await detectLanguage(word);\n    }\n\n    if (!word) return;\n\n    const provider = this.config?.pronunciationProvider || 'wiktionary';\n\n    if (provider === 'google') {\n      try {\n        await playGoogleTranslateTts(word, lang);\n        return;\n      } catch (e) {\n        // \u964D\u7EA7\u5230\u5B57\u5178\u6216 TTS\n      }\n    }\n\n    if (lang === 'en') {\n      const youdaoType = this.config?.youdaoPronunciationType ?? 2;\n\n      if (provider === 'youdao') {\n        try {\n          await playYoudaoDictVoice(word, youdaoType);\n          return;\n        } catch (e) {\n          // \u964D\u7EA7\u5230 Wiktionary \u6216 TTS\n        }\n      }\n\n      try {\n        await playDictionaryAudio(word, lang);\n        return;\n      } catch (e) {\n        // \u964D\u7EA7\u5230 TTS\n      }\n    }\n\n    // \u4F7F\u7528 Chrome TTS\n    const ttsLang = lang === 'en' ? 'en-US' :\n                    lang === 'zh-CN' ? 'zh-CN' :\n                    lang === 'ja' ? 'ja-JP' :\n                    lang === 'ko' ? 'ko-KR' : 'en-US';\n\n    chrome.runtime.sendMessage({ action: 'speak', text: word, lang: ttsLang }).catch(() => {});\n  }\n}\n", "/**\n * VocabMeld Toast \u901A\u77E5\u7EC4\u4EF6\n * \u63D0\u53D6\u81EA content.js\n */\n\n/**\n * \u663E\u793A Toast \u901A\u77E5\n * @param {string} message - \u901A\u77E5\u6D88\u606F\n */\nexport function showToast(message) {\n  const toast = document.createElement('div');\n  toast.className = 'vocabmeld-toast';\n  toast.textContent = message;\n  document.body.appendChild(toast);\n  setTimeout(() => toast.classList.add('vocabmeld-toast-show'), 10);\n  setTimeout(() => {\n    toast.classList.remove('vocabmeld-toast-show');\n    setTimeout(() => toast.remove(), 300);\n  }, 2000);\n}\n", "/**\n * VocabMeld \u914D\u7F6E\u7BA1\u7406\u6A21\u5757\n * \u7BA1\u7406\u6240\u6709\u914D\u7F6E\u9879\u548C\u9ED8\u8BA4\u503C\n */\n\n// CEFR \u96BE\u5EA6\u7B49\u7EA7\nexport const CEFR_LEVELS = ['A1', 'A2', 'B1', 'B2', 'C1', 'C2'];\n\n// \u66FF\u6362\u5F3A\u5EA6\u914D\u7F6E\nexport const INTENSITY_CONFIG = {\n  low: { maxPerParagraph: 4, label: '\u8F83\u5C11' },\n  medium: { maxPerParagraph: 8, label: '\u9002\u4E2D' },\n  high: { maxPerParagraph: 14, label: '\u8F83\u591A' }\n};\n\n// \u652F\u6301\u7684\u8BED\u8A00\nexport const SUPPORTED_LANGUAGES = {\n  native: [\n    { code: 'zh-CN', name: '\u7B80\u4F53\u4E2D\u6587' },\n    { code: 'zh-TW', name: '\u7E41\u4F53\u4E2D\u6587' },\n    { code: 'en', name: 'English' },\n    { code: 'ja', name: '\u65E5\u672C\u8A9E' },\n    { code: 'ko', name: '\uD55C\uAD6D\uC5B4' }\n  ],\n  target: [\n    { code: 'en', name: 'English' },\n    { code: 'zh-CN', name: '\u7B80\u4F53\u4E2D\u6587' },\n    { code: 'zh-TW', name: '\u7E41\u4F53\u4E2D\u6587' },\n    { code: 'ja', name: '\u65E5\u672C\u8A9E' },\n    { code: 'ko', name: '\uD55C\uAD6D\uC5B4' },\n    { code: 'fr', name: 'Fran\u00E7ais' },\n    { code: 'de', name: 'Deutsch' },\n    { code: 'es', name: 'Espa\u00F1ol' }\n  ]\n};\n\n// API \u9884\u8BBE\u914D\u7F6E\nexport const API_PRESETS = {\n  openai: {\n    name: 'OpenAI',\n    endpoint: 'https://api.openai.com/v1/chat/completions',\n    model: 'gpt-4o-mini'\n  },\n  deepseek: {\n    name: 'DeepSeek',\n    endpoint: 'https://api.deepseek.com/chat/completions',\n    model: 'deepseek-chat'\n  },\n  moonshot: {\n    name: 'Moonshot',\n    endpoint: 'https://api.moonshot.cn/v1/chat/completions',\n    model: 'moonshot-v1-8k'\n  },\n  groq: {\n    name: 'Groq',\n    endpoint: 'https://api.groq.com/openai/v1/chat/completions',\n    model: 'llama-3.1-8b-instant'\n  },\n  ollama: {\n    name: 'Ollama (\u672C\u5730)',\n    endpoint: 'http://localhost:11434/v1/chat/completions',\n    model: 'qwen2.5:7b'\n  }\n};\n\n// \u9ED8\u8BA4\u914D\u7F6E\nexport const DEFAULT_CONFIG = {\n  // API \u914D\u7F6E\n  apiEndpoint: API_PRESETS.deepseek.endpoint,\n  apiKey: '',\n  modelName: API_PRESETS.deepseek.model,\n  \n  // \u5B66\u4E60\u504F\u597D\n  nativeLanguage: 'zh-CN',\n  targetLanguage: 'en',\n  difficultyLevel: 'B1',\n  intensity: 'medium',\n  \n  // \u884C\u4E3A\u8BBE\u7F6E\n  autoProcess: false,\n  showPhonetic: true,\n  pronunciationProvider: 'wiktionary',\n  youdaoPronunciationType: 2,\n  enabled: true,\n  \n  // \u7AD9\u70B9\u89C4\u5219\n  blacklist: [],\n  whitelist: [],\n  \n  // \u7EDF\u8BA1\u6570\u636E\n  totalWords: 0,\n  todayWords: 0,\n  lastResetDate: new Date().toISOString().split('T')[0],\n  \n  // \u7F13\u5B58\u7EDF\u8BA1\n  cacheHits: 0,\n  cacheMisses: 0\n};\n\n// \u7F13\u5B58\u914D\u7F6E\nexport const CACHE_CONFIG = {\n  maxSize: 2000,\n  storageKey: 'vocabmeld_word_cache'\n};\n\n// \u9700\u8981\u8DF3\u8FC7\u7684\u6807\u7B7E\nexport const SKIP_TAGS = [\n  'SCRIPT', 'STYLE', 'NOSCRIPT', 'IFRAME', 'OBJECT', 'EMBED',\n  'CANVAS', 'SVG', 'VIDEO', 'AUDIO', 'CODE', 'PRE', 'KBD',\n  'SAMP', 'VAR', 'TEXTAREA', 'INPUT', 'SELECT', 'BUTTON'\n];\n\n// \u9700\u8981\u8DF3\u8FC7\u7684\u7C7B\u540D\nexport const SKIP_CLASSES = [\n  'vocabmeld-translated',\n  'vocabmeld-tooltip',\n  'highlight-mengshen',\n  'code',\n  'syntax',\n  'hljs'\n];\n\n/**\n * \u5224\u65AD\u8BCD\u6C47\u96BE\u5EA6\u662F\u5426\u7B26\u5408\u7528\u6237\u8BBE\u7F6E\n * @param {string} wordDifficulty - \u8BCD\u6C47\u96BE\u5EA6 (A1-C2)\n * @param {string} userDifficulty - \u7528\u6237\u8BBE\u7F6E\u96BE\u5EA6 (A1-C2)\n * @returns {boolean}\n */\nexport function isDifficultyCompatible(wordDifficulty, userDifficulty) {\n  const wordIdx = CEFR_LEVELS.indexOf(wordDifficulty);\n  const userIdx = CEFR_LEVELS.indexOf(userDifficulty);\n  // \u53EA\u663E\u793A\u5927\u4E8E\u7B49\u4E8E\u7528\u6237\u9009\u62E9\u96BE\u5EA6\u7684\u8BCD\u6C47\n  return wordIdx >= userIdx;\n}\n\n/**\n * \u83B7\u53D6\u8BED\u8A00\u663E\u793A\u540D\u79F0\n * @param {string} code - \u8BED\u8A00\u4EE3\u7801\n * @returns {string}\n */\nexport function getLanguageName(code) {\n  const all = [...SUPPORTED_LANGUAGES.native, ...SUPPORTED_LANGUAGES.target];\n  const lang = all.find(l => l.code === code);\n  return lang ? lang.name : code;\n}\n", "/**\n * VocabMeld \u5B58\u50A8\u670D\u52A1\u6A21\u5757\n * \u5C01\u88C5 Chrome Storage API\uFF0C\u63D0\u4F9B\u7EDF\u4E00\u7684\u5B58\u50A8\u63A5\u53E3\n */\n\nimport { DEFAULT_CONFIG } from './config.js';\n\n/**\n * \u5B58\u50A8\u670D\u52A1\u7C7B\n */\nclass StorageService {\n  constructor() {\n    this.cache = null;\n    this.listeners = new Map();\n  }\n\n  /**\n   * \u83B7\u53D6\u914D\u7F6E\u503C\n   * @param {string|string[]|null} keys - \u8981\u83B7\u53D6\u7684\u952E\uFF0Cnull \u5219\u83B7\u53D6\u6240\u6709\n   * @returns {Promise<object>}\n   */\n  async get(keys = null) {\n    return new Promise((resolve) => {\n      chrome.storage.sync.get(keys, (result) => {\n        if (keys === null) {\n          resolve({ ...DEFAULT_CONFIG, ...result });\n        } else if (typeof keys === 'string') {\n          resolve({ [keys]: result[keys] ?? DEFAULT_CONFIG[keys] });\n        } else {\n          const merged = {};\n          keys.forEach(key => {\n            merged[key] = result[key] ?? DEFAULT_CONFIG[key];\n          });\n          resolve(merged);\n        }\n      });\n    });\n  }\n\n  /**\n   * \u8BBE\u7F6E\u914D\u7F6E\u503C\n   * @param {object} items - \u8981\u8BBE\u7F6E\u7684\u952E\u503C\u5BF9\n   * @returns {Promise<void>}\n   */\n  async set(items) {\n    return new Promise((resolve, reject) => {\n      chrome.storage.sync.set(items, () => {\n        if (chrome.runtime.lastError) {\n          reject(chrome.runtime.lastError);\n        } else {\n          resolve();\n        }\n      });\n    });\n  }\n\n  /**\n   * \u4ECE\u672C\u5730\u5B58\u50A8\u83B7\u53D6\u6570\u636E\uFF08\u7528\u4E8E\u5927\u91CF\u6570\u636E\u5982\u7F13\u5B58\uFF09\n   * @param {string|string[]|null} keys\n   * @returns {Promise<object>}\n   */\n  async getLocal(keys = null) {\n    return new Promise((resolve) => {\n      chrome.storage.local.get(keys, (result) => {\n        resolve(result);\n      });\n    });\n  }\n\n  /**\n   * \u8BBE\u7F6E\u672C\u5730\u5B58\u50A8\u6570\u636E\n   * @param {object} items\n   * @returns {Promise<void>}\n   */\n  async setLocal(items) {\n    return new Promise((resolve, reject) => {\n      chrome.storage.local.set(items, () => {\n        if (chrome.runtime.lastError) {\n          reject(chrome.runtime.lastError);\n        } else {\n          resolve();\n        }\n      });\n    });\n  }\n\n  /**\n   * \u6E05\u9664\u672C\u5730\u5B58\u50A8\n   * @param {string|string[]} keys\n   * @returns {Promise<void>}\n   */\n  async removeLocal(keys) {\n    return new Promise((resolve) => {\n      chrome.storage.local.remove(keys, resolve);\n    });\n  }\n\n  /**\n   * \u83B7\u53D6\u5B8C\u6574\u914D\u7F6E\n   * @returns {Promise<object>}\n   */\n  async getConfig() {\n    return this.get(null);\n  }\n\n  /**\n   * \u66F4\u65B0\u7EDF\u8BA1\u6570\u636E\n   * @param {object} stats - \u7EDF\u8BA1\u6570\u636E\u66F4\u65B0\n   * @returns {Promise<void>}\n   */\n  async updateStats(stats) {\n    const current = await this.get(['totalWords', 'todayWords', 'lastResetDate', 'cacheHits', 'cacheMisses']);\n    const today = new Date().toISOString().split('T')[0];\n    \n    // \u68C0\u67E5\u662F\u5426\u9700\u8981\u91CD\u7F6E\u4ECA\u65E5\u7EDF\u8BA1\n    if (current.lastResetDate !== today) {\n      current.todayWords = 0;\n      current.lastResetDate = today;\n    }\n\n    const updated = {\n      totalWords: current.totalWords + (stats.newWords || 0),\n      todayWords: current.todayWords + (stats.newWords || 0),\n      lastResetDate: today,\n      cacheHits: current.cacheHits + (stats.cacheHits || 0),\n      cacheMisses: current.cacheMisses + (stats.cacheMisses || 0)\n    };\n\n    await this.set(updated);\n    return updated;\n  }\n\n  /**\n   * \u83B7\u53D6\u767D\u540D\u5355\uFF08\u5DF2\u5B66\u4F1A\u8BCD\u6C47\uFF09\n   * @returns {Promise<Array>}\n   */\n  async getWhitelist() {\n    const result = await this.get('learnedWords');\n    return result.learnedWords || [];\n  }\n\n  /**\n   * \u6DFB\u52A0\u8BCD\u6C47\u5230\u767D\u540D\u5355\n   * @param {object} word - { original, word, addedAt }\n   * @returns {Promise<void>}\n   */\n  async addToWhitelist(word) {\n    const whitelist = await this.getWhitelist();\n    const exists = whitelist.some(w => w.original === word.original || w.word === word.word);\n    if (!exists) {\n      whitelist.push({\n        original: word.original,\n        word: word.word,\n        addedAt: Date.now()\n      });\n      await this.set({ learnedWords: whitelist });\n    }\n  }\n\n  /**\n   * \u4ECE\u767D\u540D\u5355\u79FB\u9664\u8BCD\u6C47\n   * @param {string} word - \u8BCD\u6C47\n   * @returns {Promise<void>}\n   */\n  async removeFromWhitelist(word) {\n    const whitelist = await this.getWhitelist();\n    const filtered = whitelist.filter(w => w.original !== word && w.word !== word);\n    await this.set({ learnedWords: filtered });\n  }\n\n  /**\n   * \u83B7\u53D6\u9700\u8BB0\u5FC6\u5217\u8868\n   * @returns {Promise<Array>}\n   */\n  async getMemorizeList() {\n    const result = await this.get('memorizeList');\n    return result.memorizeList || [];\n  }\n\n  /**\n   * \u6DFB\u52A0\u8BCD\u6C47\u5230\u9700\u8BB0\u5FC6\u5217\u8868\n   * @param {string} word - \u8BCD\u6C47\n   * @returns {Promise<void>}\n   */\n  async addToMemorizeList(word) {\n    const list = await this.getMemorizeList();\n    const exists = list.some(w => w.word === word);\n    if (!exists) {\n      list.push({\n        word: word,\n        addedAt: Date.now()\n      });\n      await this.set({ memorizeList: list });\n    }\n  }\n\n  /**\n   * \u4ECE\u9700\u8BB0\u5FC6\u5217\u8868\u79FB\u9664\u8BCD\u6C47\n   * @param {string} word - \u8BCD\u6C47\n   * @returns {Promise<void>}\n   */\n  async removeFromMemorizeList(word) {\n    const list = await this.getMemorizeList();\n    const filtered = list.filter(w => w.word !== word);\n    await this.set({ memorizeList: filtered });\n  }\n\n  /**\n   * \u68C0\u67E5\u7AD9\u70B9\u662F\u5426\u5728\u9ED1\u540D\u5355\n   * @param {string} hostname - \u7AD9\u70B9\u57DF\u540D\n   * @returns {Promise<boolean>}\n   */\n  async isBlacklisted(hostname) {\n    const { blacklist } = await this.get('blacklist');\n    return (blacklist || []).some(domain => hostname.includes(domain));\n  }\n\n  /**\n   * \u68C0\u67E5\u7AD9\u70B9\u662F\u5426\u5728\u767D\u540D\u5355\n   * @param {string} hostname - \u7AD9\u70B9\u57DF\u540D\n   * @returns {Promise<boolean>}\n   */\n  async isWhitelisted(hostname) {\n    const { whitelist } = await this.get('whitelist');\n    return (whitelist || []).some(domain => hostname.includes(domain));\n  }\n\n  /**\n   * \u6DFB\u52A0\u5B58\u50A8\u53D8\u5316\u76D1\u542C\u5668\n   * @param {function} callback - \u56DE\u8C03\u51FD\u6570\n   * @returns {function} - \u53D6\u6D88\u76D1\u542C\u7684\u51FD\u6570\n   */\n  addChangeListener(callback) {\n    const listener = (changes, areaName) => {\n      if (areaName === 'sync' || areaName === 'local') {\n        callback(changes, areaName);\n      }\n    };\n    chrome.storage.onChanged.addListener(listener);\n    return () => chrome.storage.onChanged.removeListener(listener);\n  }\n}\n\n// \u5BFC\u51FA\u5355\u4F8B\nexport const storage = new StorageService();\nexport default storage;\n\n", "/**\n * VocabMeld \u7F13\u5B58\u670D\u52A1\u6A21\u5757\n * \u5B9E\u73B0\u70ED\u8BCD\u7F13\u5B58\u7CFB\u7EDF\uFF0C\u652F\u6301 LRU \u6DD8\u6C70\u7B56\u7565\n */\n\nimport { CACHE_CONFIG } from '../core/config.js';\nimport { storage } from '../core/storage.js';\n\n/**\n * \u8BCD\u6C47\u7F13\u5B58\u670D\u52A1\u7C7B\n */\nclass CacheService {\n  constructor() {\n    this.cache = new Map();\n    this.maxSize = CACHE_CONFIG.maxSize;\n    this.initialized = false;\n    this.initPromise = null;\n  }\n\n  /**\n   * \u521D\u59CB\u5316\u7F13\u5B58\uFF08\u4ECE\u5B58\u50A8\u52A0\u8F7D\uFF09\n   * @returns {Promise<void>}\n   */\n  async init() {\n    if (this.initialized) return;\n    if (this.initPromise) return this.initPromise;\n\n    this.initPromise = (async () => {\n      try {\n        const data = await storage.getLocal(CACHE_CONFIG.storageKey);\n        const cached = data[CACHE_CONFIG.storageKey];\n        \n        if (cached && Array.isArray(cached)) {\n          // \u6062\u590D\u7F13\u5B58\uFF0C\u6309\u6DFB\u52A0\u987A\u5E8F\n          cached.forEach(item => {\n            this.cache.set(item.key, {\n              translation: item.translation,\n              phonetic: item.phonetic,\n              difficulty: item.difficulty,\n              partOfSpeech: item.partOfSpeech || '',\n              shortDefinition: item.shortDefinition || '',\n              example: item.example || '',\n              timestamp: item.timestamp\n            });\n          });\n        }\n        \n        this.initialized = true;\n        console.log(`[VocabMeld] Cache initialized with ${this.cache.size} items`);\n      } catch (error) {\n        console.error('[VocabMeld] Failed to initialize cache:', error);\n        this.initialized = true;\n      }\n    })();\n\n    return this.initPromise;\n  }\n\n  /**\n   * \u751F\u6210\u7F13\u5B58\u952E\n   * @param {string} word - \u539F\u8BCD\n   * @param {string} sourceLang - \u6E90\u8BED\u8A00\n   * @param {string} targetLang - \u76EE\u6807\u8BED\u8A00\n   * @returns {string}\n   */\n  generateKey(word, sourceLang, targetLang) {\n    return `${word.toLowerCase()}:${sourceLang}:${targetLang}`;\n  }\n\n  /**\n   * \u83B7\u53D6\u7F13\u5B58\u9879\n   * @param {string} word - \u539F\u8BCD\n   * @param {string} sourceLang - \u6E90\u8BED\u8A00\n   * @param {string} targetLang - \u76EE\u6807\u8BED\u8A00\n   * @returns {object|null}\n   */\n  get(word, sourceLang, targetLang) {\n    const key = this.generateKey(word, sourceLang, targetLang);\n    const item = this.cache.get(key);\n    \n    if (item) {\n      // LRU: \u5C06\u8BBF\u95EE\u7684\u9879\u79FB\u5230\u672B\u5C3E\n      this.cache.delete(key);\n      this.cache.set(key, item);\n      return item;\n    }\n    \n    return null;\n  }\n\n  /**\n   * \u8BBE\u7F6E\u7F13\u5B58\u9879\n   * @param {string} word - \u539F\u8BCD\n   * @param {string} sourceLang - \u6E90\u8BED\u8A00\n   * @param {string} targetLang - \u76EE\u6807\u8BED\u8A00\n   * @param {object} data - { translation, phonetic, difficulty }\n   * @returns {Promise<void>}\n   */\n  async set(word, sourceLang, targetLang, data) {\n    const key = this.generateKey(word, sourceLang, targetLang);\n    \n    // \u5982\u679C\u5DF2\u5B58\u5728\uFF0C\u5148\u5220\u9664\uFF08LRU\uFF09\n    if (this.cache.has(key)) {\n      this.cache.delete(key);\n    }\n    \n    // \u5982\u679C\u8FBE\u5230\u4E0A\u9650\uFF0C\u5220\u9664\u6700\u65E9\u7684\u9879\n    while (this.cache.size >= this.maxSize) {\n      const firstKey = this.cache.keys().next().value;\n      this.cache.delete(firstKey);\n    }\n    \n    // \u6DFB\u52A0\u65B0\u9879\n    this.cache.set(key, {\n      translation: data.translation,\n      phonetic: data.phonetic || '',\n      difficulty: data.difficulty || 'B1',\n      partOfSpeech: data.partOfSpeech || '',\n      shortDefinition: data.shortDefinition || '',\n      example: data.example || '',\n      timestamp: Date.now()\n    });\n    \n    // \u5F02\u6B65\u6301\u4E45\u5316\n    this.persist();\n  }\n\n  /**\n   * \u6279\u91CF\u8BBE\u7F6E\u7F13\u5B58\n   * @param {Array} items - [{ word, sourceLang, targetLang, translation, phonetic, difficulty }]\n   * @returns {Promise<void>}\n   */\n  async setMany(items) {\n    for (const item of items) {\n      const key = this.generateKey(item.word, item.sourceLang, item.targetLang);\n      \n      if (this.cache.has(key)) {\n        this.cache.delete(key);\n      }\n      \n      while (this.cache.size >= this.maxSize) {\n        const firstKey = this.cache.keys().next().value;\n        this.cache.delete(firstKey);\n      }\n      \n      this.cache.set(key, {\n        translation: item.translation,\n        phonetic: item.phonetic || '',\n        difficulty: item.difficulty || 'B1',\n        partOfSpeech: item.partOfSpeech || '',\n        shortDefinition: item.shortDefinition || '',\n        example: item.example || '',\n        timestamp: Date.now()\n      });\n    }\n    \n    await this.persist();\n  }\n\n  /**\n   * \u68C0\u67E5\u7F13\u5B58\u4E2D\u7684\u8BCD\u6C47\n   * @param {string[]} words - \u8BCD\u6C47\u5217\u8868\n   * @param {string} sourceLang - \u6E90\u8BED\u8A00\n   * @param {string} targetLang - \u76EE\u6807\u8BED\u8A00\n   * @returns {{ cached: Map, uncached: string[] }}\n   */\n  checkWords(words, sourceLang, targetLang) {\n    const cached = new Map();\n    const uncached = [];\n    \n    for (const word of words) {\n      const item = this.get(word, sourceLang, targetLang);\n      if (item) {\n        cached.set(word, item);\n      } else {\n        uncached.push(word);\n      }\n    }\n    \n    return { cached, uncached };\n  }\n\n  /**\n   * \u6301\u4E45\u5316\u7F13\u5B58\u5230\u5B58\u50A8\n   * @returns {Promise<void>}\n   */\n  async persist() {\n    try {\n      const data = [];\n      for (const [key, value] of this.cache) {\n        data.push({\n          key,\n          ...value\n        });\n      }\n      \n      await storage.setLocal({\n        [CACHE_CONFIG.storageKey]: data\n      });\n    } catch (error) {\n      console.error('[VocabMeld] Failed to persist cache:', error);\n    }\n  }\n\n  /**\n   * \u6E05\u7A7A\u7F13\u5B58\n   * @returns {Promise<void>}\n   */\n  async clear() {\n    this.cache.clear();\n    await storage.removeLocal(CACHE_CONFIG.storageKey);\n    console.log('[VocabMeld] Cache cleared');\n  }\n\n  /**\n   * \u83B7\u53D6\u7F13\u5B58\u7EDF\u8BA1\n   * @returns {object}\n   */\n  getStats() {\n    return {\n      size: this.cache.size,\n      maxSize: this.maxSize\n    };\n  }\n\n  /**\n   * \u83B7\u53D6\u6240\u6709\u7F13\u5B58\u8BCD\u6C47\n   * @returns {Array}\n   */\n  getAllWords() {\n    const words = [];\n    for (const [key, value] of this.cache) {\n      const [word, sourceLang, targetLang] = key.split(':');\n      words.push({\n        original: word,\n        translation: value.translation,\n        phonetic: value.phonetic,\n        difficulty: value.difficulty,\n        example: value.example || '',\n        sourceLang,\n        targetLang\n      });\n    }\n    return words;\n  }\n}\n\n// \u5BFC\u51FA\u5355\u4F8B\nexport const cacheService = new CacheService();\nexport default cacheService;\n", "/**\n * VocabMeld AI Prompts Module\n * \u7EDF\u4E00\u7BA1\u7406\u6240\u6709 AI \u63D0\u793A\u8BCD\u6A21\u677F\n */\n\n/**\n * \u6784\u5EFA\u8BCD\u6C47\u9009\u62E9\u63D0\u793A\u8BCD\uFF08\u7528\u4E8E\u81EA\u52A8\u7FFB\u8BD1\u6BB5\u843D\uFF09\n * @param {object} params - \u53C2\u6570\u5BF9\u8C61\n * @param {string} params.sourceLang - \u6E90\u8BED\u8A00\n * @param {string} params.targetLang - \u76EE\u6807\u8BED\u8A00\n * @param {string} params.nativeLanguage - \u7528\u6237\u6BCD\u8BED\n * @param {string} params.learningLanguage - \u7528\u6237\u5B66\u4E60\u8BED\u8A00\n * @param {number} params.aiTargetCount - AI \u5E94\u8FD4\u56DE\u7684\u76EE\u6807\u8BCD\u6C47\u6570\n * @param {number} params.aiMaxCount - AI \u6700\u591A\u8FD4\u56DE\u7684\u8BCD\u6C47\u6570\n * @returns {string} \u5B8C\u6574\u7684\u63D0\u793A\u8BCD\n */\nexport function buildVocabularySelectionPrompt({\n  sourceLang,\n  targetLang,\n  nativeLanguage,\n  learningLanguage,\n  aiTargetCount,\n  aiMaxCount\n}) {\n  // \u5224\u65AD\u5B66\u4E60\u8BED\u8A00\u7684\u8BCD\u6C47\u5728\u54EA\u4E2A\u5B57\u6BB5\n  const isLearningFromSource = sourceLang === learningLanguage;\n  const learningWordField = isLearningFromSource ? 'original' : 'translation';\n\n  return `You are a professional language learning assistant. Your task is to analyze text and select valuable words for translation to help users learn new vocabulary.\n\n## Your Mission:\nSelect ${aiTargetCount}-${aiMaxCount} words with high learning value from the provided text.\n\n## Translation Context:\n- Source language: ${sourceLang}\n- Target language: ${targetLang}\n- User's native language: ${nativeLanguage}\n- User's learning language: ${learningLanguage}\n- **The word user is learning will be in the \"${learningWordField}\" field**\n\n## Selection Rules (MUST FOLLOW):\n1. Select ONLY ${aiTargetCount}-${aiMaxCount} words total\n2. NEVER translate: proper nouns, person names, place names, brand names, numbers, code snippets, URLs\n3. SKIP: words already in the target language\n4. Prioritize: common useful vocabulary with mixed difficulty levels\n5. Translation style: context-aware, single best meaning (not multiple definitions)\n6. **CRITICAL PHONETIC RULE**: The \"phonetic\" field MUST be the pronunciation of the \"${learningWordField}\" field (the ${learningLanguage} word), NOT the ${isLearningFromSource ? targetLang : sourceLang} word!\n\n${getCommonSections(nativeLanguage, learningLanguage, isLearningFromSource)}\n\n## Example Output (JSON ONLY):\n${isLearningFromSource ? `[\n  {\n    \"original\": \"affiliated\",\n    \"translation\": \"\u96B6\u5C5E\u7684\",\n    \"phonetic\": \"/\u0259\u02C8f\u026Alie\u026At\u026Ad/\",\n    \"difficulty\": \"B2\",\n    \"partOfSpeech\": \"adjective\",\n    \"shortDefinition\": \"officially connected or associated with an organization\",\n    \"example\": \"The hospital is affiliated with the university medical school.\"\n  },\n  {\n    \"original\": \"technology\",\n    \"translation\": \"\u6280\u672F\",\n    \"phonetic\": \"/tek\u02C8n\u0252l\u0259d\u0292i/\",\n    \"difficulty\": \"A2\",\n    \"partOfSpeech\": \"noun\",\n    \"shortDefinition\": \"the application of scientific knowledge for practical purposes\",\n    \"example\": \"Modern technology has transformed the way we communicate.\"\n  }\n]` : `[\n  {\n    \"original\": \"\u827A\u672F\u5BB6\",\n    \"translation\": \"artist\",\n    \"phonetic\": \"/\u02C8\u0251\u02D0t\u026Ast/\",\n    \"difficulty\": \"B2\",\n    \"partOfSpeech\": \"noun\",\n    \"shortDefinition\": \"a person who creates art, especially paintings or drawings\",\n    \"example\": \"The artist spent years perfecting her technique.\"\n  },\n  {\n    \"original\": \"\u6280\u672F\",\n    \"translation\": \"technology\",\n    \"phonetic\": \"/tek\u02C8n\u0252l\u0259d\u0292i/\",\n    \"difficulty\": \"A2\",\n    \"partOfSpeech\": \"noun\",\n    \"shortDefinition\": \"the application of scientific knowledge for practical purposes\",\n    \"example\": \"Technology continues to advance at a rapid pace.\"\n  }\n]`}`;\n}\n\n/**\n * \u6784\u5EFA\u7279\u5B9A\u5355\u8BCD\u7FFB\u8BD1\u63D0\u793A\u8BCD\uFF08\u7528\u4E8E\u8BB0\u5FC6\u5217\u8868\uFF09\n * @param {object} params - \u53C2\u6570\u5BF9\u8C61\n * @param {string} params.sourceLang - \u6E90\u8BED\u8A00\n * @param {string} params.targetLang - \u76EE\u6807\u8BED\u8A00\n * @param {string} params.nativeLanguage - \u7528\u6237\u6BCD\u8BED\n * @param {string} params.learningLanguage - \u7528\u6237\u5B66\u4E60\u8BED\u8A00\n * @returns {string} \u5B8C\u6574\u7684\u63D0\u793A\u8BCD\n */\nexport function buildSpecificWordsPrompt({\n  sourceLang,\n  targetLang,\n  nativeLanguage,\n  learningLanguage\n}) {\n  // \u5224\u65AD\u5B66\u4E60\u8BED\u8A00\u7684\u8BCD\u6C47\u5728\u54EA\u4E2A\u5B57\u6BB5\n  const isLearningFromSource = sourceLang === learningLanguage;\n  const learningWordField = isLearningFromSource ? 'original' : 'translation';\n\n  return `You are a language learning assistant. Translate the specific words provided by the user.\n\n## Rules:\n1. Translate every provided word; do not skip any\n2. If a word is in ${sourceLang}, translate it to ${targetLang}; otherwise translate it the other way\n3. **CRITICAL PHONETIC RULE**: The \"phonetic\" field MUST be the pronunciation of the \"${learningWordField}\" field (the ${learningLanguage} word), NOT the ${isLearningFromSource ? targetLang : sourceLang} word!\n\n${getCommonSections(nativeLanguage, learningLanguage, isLearningFromSource)}\n\n## Example Output (JSON ONLY):\n${isLearningFromSource ? `[\n  {\n    \"original\": \"affiliated\",\n    \"translation\": \"\u96B6\u5C5E\u7684\",\n    \"phonetic\": \"/\u0259\u02C8f\u026Alie\u026At\u026Ad/\",\n    \"difficulty\": \"B2\",\n    \"partOfSpeech\": \"adjective\",\n    \"shortDefinition\": \"officially connected or associated with an organization\",\n    \"example\": \"The hospital is affiliated with the university medical school.\"\n  }\n]` : `[\n  {\n    \"original\": \"\u6280\u672F\",\n    \"translation\": \"technology\",\n    \"phonetic\": \"/tek\u02C8n\u0252l\u0259d\u0292i/\",\n    \"difficulty\": \"A2\",\n    \"partOfSpeech\": \"noun\",\n    \"shortDefinition\": \"the application of scientific knowledge for practical purposes\",\n    \"example\": \"Technology continues to advance at a rapid pace.\"\n  }\n]`}\n\n## Output:\nReturn only the JSON array and nothing else.`;\n}\n\n/**\n * \u83B7\u53D6\u5171\u4EAB\u7684\u63D0\u793A\u8BCD\u90E8\u5206\uFF08CEFR\u3001\u97F3\u6807\u89C4\u5219\u3001\u8F93\u51FA\u683C\u5F0F\uFF09\n * @param {string} nativeLanguage - \u7528\u6237\u6BCD\u8BED\n * @param {string} learningLanguage - \u7528\u6237\u5B66\u4E60\u8BED\u8A00\n * @param {boolean} isLearningFromSource - \u5B66\u4E60\u8BED\u8A00\u8BCD\u6C47\u662F\u5426\u5728 original \u5B57\u6BB5\n * @returns {string} \u5171\u4EAB\u7684\u63D0\u793A\u8BCD\u90E8\u5206\n */\nfunction getCommonSections(nativeLanguage, learningLanguage, isLearningFromSource) {\n  const learningWordField = isLearningFromSource ? 'original' : 'translation';\n\n  return `## CEFR Difficulty Levels:\nA1 \u2192 A2 \u2192 B1 \u2192 B2 \u2192 C1 \u2192 C2\n\n## Phonetic Format Rules:\n- For English: use IPA like \"/\u0259\u02C8f\u026Alie\u026At\u026Ad/\" or \"/tek\u02C8n\u0252l\u0259d\u0292i/\"\n- For Chinese: use pinyin with tones like \"l\u00EDng g\u01CEn\"\n- For Japanese: use romaji like \"ko-n-ni-chi-wa\"\n- For Korean: use romanization like \"an-nyeong\"\n- **IMPORTANT: The phonetic MUST be the pronunciation of the \"${learningWordField}\" field (${learningLanguage}), NOT the other field!**\n\n## Required Output Fields:\n- **original**: the original word from the text\n- **translation**: the translated word in target language\n- **phonetic**: pronunciation of the ${learningLanguage} word (from the \"${learningWordField}\" field)\n- **difficulty**: CEFR level (A1/A2/B1/B2/C1/C2)\n- **partOfSpeech**: grammatical category in learning language (${learningLanguage}) - e.g., \"noun\", \"verb\", \"adjective\"\n- **shortDefinition**: brief definition in learning language (${learningLanguage}) - keep it concise (1-2 sentences max)\n- **example**: a natural example sentence in learning language (${learningLanguage}) using the word in context`;\n}\n", "/**\n * VocabMeld \u6587\u672C\u5904\u7406\u5DE5\u5177\n * \u63D0\u53D6\u81EA content.js\n */\n\nimport { STOP_WORDS } from '../config/constants.js';\n\n/**\n * \u5BF9\u6587\u672C\u8FDB\u884C\u5206\u8BCD\n * @param {string} text - \u8981\u5206\u8BCD\u7684\u6587\u672C\n * @param {string} lang - \u8BED\u8A00\u7C7B\u578B (Chinese/English/Japanese/Korean)\n * @returns {Array<string>} \u5206\u8BCD\u7ED3\u679C\n */\nexport function segmentText(text, lang) {\n  if (!text || typeof text !== 'string') return [];\n\n  // \u4E2D\u6587\u5206\u8BCD\n  if (lang === 'Chinese') {\n    try {\n      const segment = new window.Segment();\n      segment.useDefault();\n\n      const words = segment.doSegment(text, {\n        simple: true,\n        stripPunctuation: true\n      });\n\n      // \u8FC7\u6EE4\u6389\u7A7A\u5B57\u7B26\u4E32\u548C\u7EAF\u6807\u70B9\u7B26\u53F7\n      return words.filter(w => w && w.trim().length > 0 && /[\\u4e00-\\u9fff]/.test(w));\n    } catch (error) {\n      console.error('\u4E2D\u6587\u5206\u8BCD\u5931\u8D25\uFF0C\u4F7F\u7528\u964D\u7EA7\u65B9\u6848:', error);\n      // \u964D\u7EA7\u65B9\u6848\uFF1A\u7B80\u5355\u7684\u5B57\u7B26\u5207\u5206\n      return text.match(/[\\u4e00-\\u9fff]+/g) || [];\n    }\n  }\n\n  // \u82F1\u6587\u5206\u8BCD\uFF1A\u6309\u7A7A\u683C\u5206\u8BCD\uFF0C\u53BB\u9664\u6240\u6709\u6807\u70B9\u7B26\u53F7\n  if (lang === 'English') {\n    return text\n      .replace(/[^\\w\\s]/g, ' ') // \u79FB\u9664\u6240\u6709\u6807\u70B9\u7B26\u53F7\n      .split(/\\s+/) // \u6309\u7A7A\u683C\u5206\u8BCD\n      .filter(w => w && w.length > 0 && /[a-zA-Z]/.test(w)); // \u8FC7\u6EE4\u7A7A\u8BCD\u548C\u7EAF\u6570\u5B57\n  }\n\n  // \u65E5\u6587\u548C\u97E9\u6587\u6682\u65F6\u4F7F\u7528\u7B80\u5355\u5206\u8BCD\n  if (lang === 'Japanese') {\n    return text.match(/[\\u3040-\\u309f\\u30a0-\\u30ff\\u4e00-\\u9fff]+/g) || [];\n  }\n\n  if (lang === 'Korean') {\n    return text.match(/[\\uac00-\\ud7af]+/g) || [];\n  }\n\n  // \u9ED8\u8BA4\u6309\u7A7A\u683C\u5206\u8BCD\n  return text.split(/\\s+/).filter(w => w && w.trim().length > 0);\n}\n\n/**\n * \u91CD\u5EFA\u6587\u672C\uFF0C\u53EA\u4FDD\u7559\u6307\u5B9A\u7684\u8BCD\u6C47\uFF08\u7528\u4E8E\u53D1\u9001\u7ED9 AI\uFF09\n * @param {string} text - \u539F\u59CB\u6587\u672C\n * @param {string[]} targetWords - \u8981\u4FDD\u7559\u7684\u8BCD\u6C47\n * @returns {string} \u8FC7\u6EE4\u540E\u7684\u6587\u672C\n */\nexport function reconstructTextWithWords(text, targetWords) {\n  const targetWordSet = new Set(targetWords.map(w => w.toLowerCase()));\n  const lowerText = text.toLowerCase();\n  const sentences = text.split(/[.!?]+/).filter(s => s.trim().length > 0);\n\n  const relevantSentences = sentences.filter(sentence => {\n    const lowerSentence = sentence.toLowerCase();\n    // \u68C0\u67E5\u82F1\u6587\u5355\u8BCD\n    const words = sentence.match(/\\b[a-zA-Z]{5,}\\b/g) || [];\n    const hasEnglishMatch = words.some(word => targetWordSet.has(word.toLowerCase()));\n\n    // \u68C0\u67E5\u4E2D\u6587\u77ED\u8BED\uFF08\u76F4\u63A5\u68C0\u67E5\u662F\u5426\u5305\u542B\u76EE\u6807\u8BCD\u6C47\uFF09\n    const hasChineseMatch = Array.from(targetWordSet).some(word => {\n      // \u53EA\u68C0\u67E5\u4E2D\u6587\u8BCD\u6C47\n      if (/[\\u4e00-\\u9fff]/.test(word)) {\n        return lowerSentence.includes(word);\n      }\n      return false;\n    });\n\n    return hasEnglishMatch || hasChineseMatch;\n  });\n\n  return relevantSentences.join('. ').trim() + (relevantSentences.length > 0 ? '.' : '');\n}\n\n/**\n * \u8FC7\u6EE4\u505C\u7528\u8BCD\u548C\u8FC7\u77ED\u7684\u8BCD\n * @param {Array<string>} words - \u8BCD\u6C47\u6570\u7EC4\n * @returns {Array<string>} \u8FC7\u6EE4\u540E\u7684\u8BCD\u6C47\n */\nexport function filterWords(words) {\n  return words.filter(word => {\n    const lower = word.toLowerCase();\n    // \u82F1\u6587\uFF1A\u8FC7\u6EE4\u505C\u7528\u8BCD\u548C\u77ED\u8BCD\uFF08<5\u5B57\u7B26\uFF09\n    if (/^[a-zA-Z]+$/.test(word)) {\n      return !STOP_WORDS.has(lower) && word.length >= 5;\n    }\n    // \u4E2D\u6587\uFF1A\u8FC7\u6EE4\u5355\u5B57\uFF08\u53EA\u4FDD\u75592\u5B57\u4EE5\u4E0A\uFF09\n    if (/[\\u4e00-\\u9fff]/.test(word)) {\n      return word.length >= 2;\n    }\n    // \u5176\u4ED6\u8BED\u8A00\uFF1A\u4FDD\u7559\n    return true;\n  });\n}\n", "/**\n * VocabMeld API \u670D\u52A1\u6A21\u5757\uFF08\u91CD\u6784\u7248\uFF09\n * \u5904\u7406\u4E0E LLM API \u7684\u901A\u4FE1\uFF0C\u7EDF\u4E00\u7BA1\u7406\u7FFB\u8BD1\u903B\u8F91\n */\n\nimport { INTENSITY_CONFIG, isDifficultyCompatible, CACHE_CONFIG } from '../core/config.js';\nimport { cacheService } from './cache-service.js';\nimport { buildVocabularySelectionPrompt, buildSpecificWordsPrompt } from '../prompts/ai-prompts.js';\nimport { detectLanguage } from '../utils/language-detector.js';\nimport { isNonLearningWord } from '../utils/word-filters.js';\nimport { segmentText, reconstructTextWithWords, filterWords } from '../utils/text-processor.js';\n\n/**\n * API \u670D\u52A1\u7C7B\n */\nclass ApiService {\n  constructor() {\n    this.config = null;\n  }\n\n  /**\n   * \u8BBE\u7F6E\u914D\u7F6E\n   * @param {object} config - \u914D\u7F6E\u5BF9\u8C61\n   */\n  setConfig(config) {\n    this.config = config;\n  }\n\n  /**\n   * \u89E3\u6790 API \u54CD\u5E94\uFF08\u7EDF\u4E00 JSON \u89E3\u6790\u903B\u8F91\uFF09\n   * @param {string} content - API \u8FD4\u56DE\u5185\u5BB9\n   * @returns {Array}\n   */\n  parseApiResponse(content) {\n    try {\n      let parsed = JSON.parse(content);\n      if (Array.isArray(parsed)) return parsed;\n\n      if (parsed.results && Array.isArray(parsed.results)) {\n        return parsed.results;\n      }\n      if (parsed.words && Array.isArray(parsed.words)) {\n        return parsed.words;\n      }\n\n      return [];\n    } catch (e) {\n      const jsonMatch = content.match(/\\[[\\s\\S]*\\]/);\n      if (jsonMatch) {\n        try {\n          return JSON.parse(jsonMatch[0]);\n        } catch (e2) {\n          console.error('[VocabMeld] Failed to parse API response:', e2);\n        }\n      }\n      return [];\n    }\n  }\n\n  /**\n   * \u66F4\u65B0\u7F13\u5B58\uFF08\u7EDF\u4E00 LRU \u7BA1\u7406\uFF09\n   * @param {Array} results - AI \u8FD4\u56DE\u7684\u7ED3\u679C\n   * @param {string} sourceLang - \u6E90\u8BED\u8A00\n   * @param {string} targetLang - \u76EE\u6807\u8BED\u8A00\n   */\n  async updateCache(results, sourceLang, targetLang) {\n    const cacheItems = [];\n\n    for (const item of results) {\n      const word = item.original || '';\n      if (isNonLearningWord(word)) continue;\n\n      const isChinese = /[\\u4e00-\\u9fff]/.test(word);\n      if (isChinese && word.length < 2) continue;\n\n      const isEnglish = /^[a-zA-Z]+$/.test(word);\n      if (isEnglish && word.length < 5) continue;\n\n      cacheItems.push({\n        word,\n        sourceLang,\n        targetLang,\n        translation: item.translation,\n        phonetic: item.phonetic || '',\n        difficulty: item.difficulty || 'B1',\n        partOfSpeech: item.partOfSpeech || '',\n        shortDefinition: item.shortDefinition || '',\n        example: item.example || ''\n      });\n    }\n\n    if (cacheItems.length > 0) {\n      await cacheService.setMany(cacheItems);\n    }\n  }\n\n  /**\n   * \u7FFB\u8BD1\u6587\u672C\uFF08\u652F\u6301\u7ACB\u5373\u8FD4\u56DE\u7F13\u5B58 + \u5F02\u6B65 API\uFF09\n   * @param {string} text - \u8981\u7FFB\u8BD1\u7684\u6587\u672C\n   * @param {object} config - \u914D\u7F6E\u5BF9\u8C61\n   * @param {object} cacheMap - \u5916\u90E8\u4F20\u5165\u7684\u7F13\u5B58 Map\uFF08content.js \u7684 wordCache\uFF09\n   * @param {function} updateStatsCallback - \u66F4\u65B0\u7EDF\u8BA1\u7684\u56DE\u8C03\u51FD\u6570\n   * @param {function} saveCacheCallback - \u4FDD\u5B58\u7F13\u5B58\u7684\u56DE\u8C03\u51FD\u6570\n   * @returns {Promise<{immediate: Array, async: Promise|null}>}\n   */\n  async translateText(text, config, cacheMap, updateStatsCallback, saveCacheCallback) {\n    if (!config.apiKey || !config.apiEndpoint) {\n      throw new Error('API \u672A\u914D\u7F6E');\n    }\n\n    const sourceLang = await detectLanguage(text);\n    const targetLang = sourceLang === config.nativeLanguage ? config.targetLanguage : config.nativeLanguage;\n    const maxReplacements = INTENSITY_CONFIG[config.intensity]?.maxPerParagraph || 8;\n\n    // \u5206\u8BCD\n    const segmentedWords = segmentText(text, sourceLang);\n    const allWords = filterWords(segmentedWords);\n\n    // \u68C0\u67E5\u7F13\u5B58\n    const cached = [];\n    const uncached = [];\n    const cachedWordsSet = new Set();\n\n    for (const word of allWords) {\n      const key = `${word.toLowerCase()}:${sourceLang}:${targetLang}`;\n      if (cacheMap.has(key)) {\n        const lowerWord = word.toLowerCase();\n        if (!cachedWordsSet.has(lowerWord)) {\n          cached.push({ word, ...cacheMap.get(key) });\n          cachedWordsSet.add(lowerWord);\n        }\n      } else {\n        uncached.push(word);\n      }\n    }\n\n    // \u989D\u5916\u68C0\u67E5\uFF1A\u68C0\u67E5\u6587\u672C\u4E2D\u662F\u5426\u5305\u542B\u5DF2\u7F13\u5B58\u7684\u4E2D\u6587\u8BCD\u6C47\n    const lowerText = text.toLowerCase();\n    for (const [key, value] of cacheMap) {\n      const [cachedWord, cachedSourceLang, cachedTargetLang] = key.split(':');\n      if (cachedSourceLang === sourceLang &&\n          cachedTargetLang === targetLang &&\n          /[\\u4e00-\\u9fff]/.test(cachedWord) &&\n          cachedWord.length >= 2) {\n        const lowerCachedWord = cachedWord.toLowerCase();\n        if (!cachedWordsSet.has(lowerCachedWord)) {\n          if (lowerText.includes(lowerCachedWord)) {\n            const idx = text.toLowerCase().indexOf(lowerCachedWord);\n            if (idx >= 0) {\n              cached.push({\n                word: text.substring(idx, idx + cachedWord.length),\n                ...value\n              });\n              cachedWordsSet.add(lowerCachedWord);\n            }\n          }\n        }\n      }\n    }\n\n    // \u8FC7\u6EE4\u7F13\u5B58\u7ED3\u679C\uFF08\u6309\u96BE\u5EA6\uFF09\n    const filteredCached = cached\n      .filter(c => isDifficultyCompatible(c.difficulty || 'B1', config.difficultyLevel))\n      .map(c => {\n        const idx = text.toLowerCase().indexOf(c.word.toLowerCase());\n        return {\n          original: c.word,\n          translation: c.translation,\n          phonetic: c.phonetic,\n          difficulty: c.difficulty,\n          partOfSpeech: c.partOfSpeech || '',\n          shortDefinition: c.shortDefinition || '',\n          example: c.example || '',\n          position: idx >= 0 ? idx : 0,\n          fromCache: true,\n          sourceLang\n        };\n      });\n\n    // \u7ACB\u5373\u8FD4\u56DE\u7F13\u5B58\u7ED3\u679C\n    const immediateResults = filteredCached.slice(0, maxReplacements);\n\n    if (immediateResults.length > 0) {\n      updateStatsCallback({ cacheHits: immediateResults.length, cacheMisses: 0 });\n    }\n\n    // \u5982\u679C\u6CA1\u6709\u672A\u7F13\u5B58\u7684\u8BCD\u6C47\uFF0C\u76F4\u63A5\u8FD4\u56DE\n    if (uncached.length === 0) {\n      return { immediate: immediateResults, async: null };\n    }\n\n    // \u6784\u5EFA\u53EA\u5305\u542B\u672A\u7F13\u5B58\u8BCD\u6C47\u7684\u6587\u672C\n    const filteredText = reconstructTextWithWords(text, uncached);\n\n    const cacheSatisfied = immediateResults.length >= maxReplacements;\n    const textTooShort = filteredText.trim().length < 50;\n\n    if (textTooShort) {\n      return { immediate: immediateResults, async: null };\n    }\n\n    const remainingSlots = maxReplacements - immediateResults.length;\n    const maxAsyncReplacements = cacheSatisfied ? 1 : remainingSlots;\n\n    if (maxAsyncReplacements <= 0) {\n      return { immediate: immediateResults, async: null };\n    }\n\n    const aiTargetCount = cacheSatisfied\n      ? 1\n      : Math.max(maxAsyncReplacements, Math.ceil(maxReplacements * 1.5));\n    const aiMaxCount = maxReplacements * 2;\n\n    // \u5F02\u6B65\u8C03\u7528 API\n    const asyncPromise = (async () => {\n      try {\n        const systemPrompt = buildVocabularySelectionPrompt({\n          sourceLang,\n          targetLang,\n          nativeLanguage: config.nativeLanguage,\n          learningLanguage: config.targetLanguage,\n          aiTargetCount,\n          aiMaxCount\n        });\n\n        const userPrompt = `${filteredText}`;\n\n        const response = await fetch(config.apiEndpoint, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            'Authorization': `Bearer ${config.apiKey}`\n          },\n          body: JSON.stringify({\n            model: config.modelName,\n            messages: [\n              { role: 'system', content: systemPrompt },\n              { role: 'user', content: userPrompt }\n            ],\n            temperature: 0,\n            max_tokens: 4096\n          })\n        });\n\n        if (!response.ok) {\n          const error = await response.json().catch(() => ({}));\n          throw new Error(error.error?.message || `API Error: ${response.status}`);\n        }\n\n        const data = await response.json();\n        const content = data.choices?.[0]?.message?.content || '[]';\n\n        let allResults = this.parseApiResponse(content);\n\n        // \u7F13\u5B58\u6240\u6709\u7ED3\u679C\n        for (const item of allResults) {\n          const word = item.original || '';\n          if (isNonLearningWord(word)) continue;\n\n          const isChinese = /[\\u4e00-\\u9fff]/.test(word);\n          if (isChinese && word.length < 2) continue;\n\n          const isEnglish = /^[a-zA-Z]+$/.test(word);\n          if (isEnglish && word.length < 5) continue;\n\n          const key = `${word.toLowerCase()}:${sourceLang}:${targetLang}`;\n\n          // LRU: \u5982\u679C\u5DF2\u5B58\u5728\uFF0C\u5148\u5220\u9664\n          if (cacheMap.has(key)) {\n            cacheMap.delete(key);\n          }\n\n          // \u5982\u679C\u8FBE\u5230\u4E0A\u9650\uFF0C\u5220\u9664\u6700\u65E9\u7684\u9879\n          while (cacheMap.size >= CACHE_CONFIG.maxSize) {\n            const firstKey = cacheMap.keys().next().value;\n            cacheMap.delete(firstKey);\n          }\n\n          // \u6DFB\u52A0\u65B0\u9879\n          cacheMap.set(key, {\n            translation: item.translation,\n            phonetic: item.phonetic || '',\n            difficulty: item.difficulty || 'B1',\n            partOfSpeech: item.partOfSpeech || '',\n            shortDefinition: item.shortDefinition || '',\n            example: item.example || ''\n          });\n        }\n\n        // \u4FDD\u5B58\u7F13\u5B58\n        await saveCacheCallback();\n\n        // \u672C\u5730\u8FC7\u6EE4\uFF1A\u53EA\u4FDD\u7559\u7B26\u5408\u7528\u6237\u96BE\u5EA6\u8BBE\u7F6E\u7684\u8BCD\u6C47\n        const filteredResults = allResults.filter(item => {\n          const word = item.original || '';\n          if (isNonLearningWord(word)) return false;\n          if (!isDifficultyCompatible(item.difficulty || 'B1', config.difficultyLevel)) return false;\n\n          const isEnglish = /^[a-zA-Z]+$/.test(word);\n          if (isEnglish && word.length < 5) return false;\n\n          return true;\n        });\n\n        // \u66F4\u65B0\u7EDF\u8BA1\n        updateStatsCallback({ newWords: filteredResults.length, cacheHits: cached.length, cacheMisses: 1 });\n\n        // \u4FEE\u6B63 AI \u8FD4\u56DE\u7ED3\u679C\u7684\u4F4D\u7F6E\n        const correctedResults = filteredResults.map(result => {\n          const originalIndex = text.toLowerCase().indexOf(result.original.toLowerCase());\n          return {\n            ...result,\n            position: originalIndex >= 0 ? originalIndex : result.position,\n            sourceLang\n          };\n        });\n\n        // \u5408\u5E76\u7F13\u5B58\u7ED3\u679C\uFF08\u53BB\u91CD\uFF09\n        const immediateWords = new Set(immediateResults.map(r => r.original.toLowerCase()));\n        const cachedResults = cached\n          .filter(c =>\n            !immediateWords.has(c.word.toLowerCase()) &&\n            !correctedResults.some(r => r.original.toLowerCase() === c.word.toLowerCase()) &&\n            isDifficultyCompatible(c.difficulty || 'B1', config.difficultyLevel) &&\n            !isNonLearningWord(c.word)\n          )\n          .map(c => {\n            const idx = text.toLowerCase().indexOf(c.word.toLowerCase());\n            return {\n              original: c.word,\n              translation: c.translation,\n              phonetic: c.phonetic,\n              difficulty: c.difficulty,\n              partOfSpeech: c.partOfSpeech || '',\n              shortDefinition: c.shortDefinition || '',\n              example: c.example || '',\n              position: idx,\n              fromCache: true,\n              sourceLang\n            };\n          });\n\n        const mergedResults = [...cachedResults, ...correctedResults];\n        return mergedResults.slice(0, maxAsyncReplacements);\n\n      } catch (error) {\n        console.error('[VocabMeld] Async translation error:', error);\n        return [];\n      }\n    })();\n\n    return { immediate: immediateResults, async: asyncPromise };\n  }\n\n  /**\n   * \u7FFB\u8BD1\u7279\u5B9A\u5355\u8BCD\uFF08\u7528\u4E8E\u8BB0\u5FC6\u5217\u8868\uFF09\n   * @param {string[]} targetWords - \u8981\u7FFB\u8BD1\u7684\u5355\u8BCD\u6570\u7EC4\n   * @param {object} config - \u914D\u7F6E\u5BF9\u8C61\n   * @param {object} cacheMap - \u5916\u90E8\u4F20\u5165\u7684\u7F13\u5B58 Map\n   * @param {function} updateStatsCallback - \u66F4\u65B0\u7EDF\u8BA1\u7684\u56DE\u8C03\u51FD\u6570\n   * @param {function} saveCacheCallback - \u4FDD\u5B58\u7F13\u5B58\u7684\u56DE\u8C03\u51FD\u6570\n   * @returns {Promise<Array>} \u7FFB\u8BD1\u7ED3\u679C\n   */\n  async translateSpecificWords(targetWords, config, cacheMap, updateStatsCallback, saveCacheCallback) {\n    if (!config.apiKey || !config.apiEndpoint || !targetWords?.length) {\n      return [];\n    }\n\n    const sourceLang = await detectLanguage(targetWords.join(' '));\n    const targetLang = sourceLang === config.nativeLanguage ? config.targetLanguage : config.nativeLanguage;\n\n    const uncached = [];\n    const cached = [];\n\n    // \u68C0\u67E5\u7F13\u5B58\n    for (const word of targetWords) {\n      const key = `${word.toLowerCase()}:${sourceLang}:${targetLang}`;\n      if (cacheMap.has(key)) {\n        // LRU: \u8BBF\u95EE\u65F6\u79FB\u5230\u672B\u5C3E\n        const cachedItem = cacheMap.get(key);\n        cacheMap.delete(key);\n        cacheMap.set(key, cachedItem);\n        cached.push({ word, ...cachedItem });\n      } else {\n        uncached.push(word);\n      }\n    }\n\n    let allResults = cached.map(c => ({\n      original: c.word,\n      translation: c.translation,\n      phonetic: c.phonetic,\n      difficulty: c.difficulty,\n      partOfSpeech: c.partOfSpeech || '',\n      shortDefinition: c.shortDefinition || '',\n      example: c.example || '',\n      sourceLang\n    }));\n\n    // \u5982\u679C\u6709\u672A\u7F13\u5B58\u7684\u5355\u8BCD\uFF0C\u8C03\u7528 API\n    if (uncached.length > 0) {\n      try {\n        const systemPrompt = buildSpecificWordsPrompt({\n          sourceLang,\n          targetLang,\n          nativeLanguage: config.nativeLanguage,\n          learningLanguage: config.targetLanguage\n        });\n\n        // \u7528\u6237\u6D88\u606F\u53EA\u5305\u542B\u8981\u7FFB\u8BD1\u7684\u5355\u8BCD\u5217\u8868\uFF08\u9017\u53F7\u5206\u9694\uFF09\n        const userPrompt = uncached.join(', ');\n\n        const response = await fetch(config.apiEndpoint, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            'Authorization': `Bearer ${config.apiKey}`\n          },\n          body: JSON.stringify({\n            model: config.modelName,\n            messages: [\n              { role: 'system', content: systemPrompt },\n              { role: 'user', content: userPrompt }\n            ],\n            temperature: 0,\n            max_tokens: 4096\n          })\n        });\n\n        if (!response.ok) {\n          const error = await response.json().catch(() => ({}));\n          throw new Error(error.error?.message || `API Error: ${response.status}`);\n        }\n\n        const data = await response.json();\n        const content = data.choices?.[0]?.message?.content || '[]';\n\n        let apiResults = this.parseApiResponse(content);\n\n        // \u7F13\u5B58\u7ED3\u679C\n        for (const item of apiResults) {\n          const word = item.original || '';\n          if (isNonLearningWord(word)) continue;\n\n          const isChinese = /[\\u4e00-\\u9fff]/.test(word);\n          if (isChinese && word.length < 2) continue;\n\n          const isEnglish = /^[a-zA-Z]+$/.test(word);\n          if (isEnglish && word.length < 5) continue;\n\n          const key = `${word.toLowerCase()}:${sourceLang}:${targetLang}`;\n\n          // LRU \u7BA1\u7406\n          if (cacheMap.has(key)) {\n            cacheMap.delete(key);\n          }\n\n          while (cacheMap.size >= CACHE_CONFIG.maxSize) {\n            const firstKey = cacheMap.keys().next().value;\n            cacheMap.delete(firstKey);\n          }\n\n          cacheMap.set(key, {\n            translation: item.translation,\n            phonetic: item.phonetic || '',\n            difficulty: item.difficulty || 'B1',\n            partOfSpeech: item.partOfSpeech || '',\n            shortDefinition: item.shortDefinition || '',\n            example: item.example || ''\n          });\n        }\n\n        // \u4FDD\u5B58\u7F13\u5B58\n        await saveCacheCallback();\n\n        // \u4E3A API \u7ED3\u679C\u6DFB\u52A0 sourceLang\n        const apiResultsWithLang = apiResults.map(item => ({\n          ...item,\n          sourceLang\n        }));\n\n        allResults = [...allResults, ...apiResultsWithLang];\n\n        // \u66F4\u65B0\u7EDF\u8BA1\n        updateStatsCallback({ newWords: apiResults.length, cacheHits: cached.length, cacheMisses: 1 });\n\n      } catch (error) {\n        console.error('[VocabMeld] translateSpecificWords error:', error);\n      }\n    }\n\n    return allResults.filter(item =>\n      targetWords.some(w => w.toLowerCase() === item.original.toLowerCase()) &&\n      !isNonLearningWord(item.original)\n    );\n  }\n}\n\n// \u5BFC\u51FA\u5355\u4F8B\nexport const apiService = new ApiService();\nexport default apiService;\n", "/**\n * VocabMeld \u5185\u5BB9\u5206\u6BB5\u5668\u6A21\u5757\n * \u667A\u80FD\u5206\u6BB5\u9875\u9762\u5185\u5BB9\uFF0C\u5E73\u8861\u5904\u7406\u6279\u6B21\u5927\u5C0F\u548C\u4E0A\u4E0B\u6587\u76F8\u5173\u6027\n */\n\nimport { SKIP_TAGS, SKIP_CLASSES } from '../config/constants.js';\nimport { isCodeText } from '../utils/word-filters.js';\n\n/**\n * \u5185\u5BB9\u5206\u6BB5\u5668\u7C7B\n */\nclass ContentSegmenter {\n  constructor() {\n    this.minSegmentLength = 50;   // \u6700\u5C0F\u5206\u6BB5\u957F\u5EA6\n    this.maxSegmentLength = 2000; // \u6700\u5927\u5206\u6BB5\u957F\u5EA6\n    this.processedFingerprints = new Set();\n  }\n\n  /**\n   * \u68C0\u67E5\u8282\u70B9\u662F\u5426\u5E94\u8BE5\u8DF3\u8FC7\n   * @param {Node} node - DOM \u8282\u70B9\n   * @returns {boolean}\n   */\n  shouldSkipNode(node) {\n    if (!node) return true;\n\n    // \u8DF3\u8FC7\u975E\u5143\u7D20\u8282\u70B9\uFF08\u9664\u4E86\u6587\u672C\u8282\u70B9\uFF09\n    if (node.nodeType !== Node.ELEMENT_NODE && node.nodeType !== Node.TEXT_NODE) {\n      return true;\n    }\n\n    // \u6587\u672C\u8282\u70B9\u68C0\u67E5\u7236\u5143\u7D20\n    if (node.nodeType === Node.TEXT_NODE) {\n      return this.shouldSkipNode(node.parentElement);\n    }\n\n    const element = node;\n\n    // \u8DF3\u8FC7\u7279\u5B9A\u6807\u7B7E\n    if (SKIP_TAGS.includes(element.tagName)) {\n      return true;\n    }\n\n    // \u8DF3\u8FC7\u7279\u5B9A\u7C7B\u540D\n    const classList = element.className?.toString() || '';\n    if (SKIP_CLASSES.some(cls => classList.includes(cls))) {\n      return true;\n    }\n\n    // \u8DF3\u8FC7\u9690\u85CF\u5143\u7D20\n    try {\n      const style = window.getComputedStyle(element);\n      if (style.display === 'none' || style.visibility === 'hidden') {\n        return true;\n      }\n    } catch (e) {}\n\n    // \u8DF3\u8FC7\u53EF\u7F16\u8F91\u5143\u7D20\n    if (element.isContentEditable) {\n      return true;\n    }\n\n    // \u8DF3\u8FC7\u5DF2\u5904\u7406\u7684\u5143\u7D20\n    if (element.hasAttribute('data-vocabmeld-processed')) {\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * \u751F\u6210\u5185\u5BB9\u6307\u7EB9\n   * @param {string} text - \u6587\u672C\u5185\u5BB9\n   * @param {string} path - DOM \u8DEF\u5F84\n   * @returns {string}\n   */\n  generateFingerprint(text, path = '') {\n    // \u53D6\u524D100\u5B57\u7B26\u4F5C\u4E3A\u6307\u7EB9\u57FA\u7840\n    const content = text.slice(0, 100).trim();\n    let hash = 0;\n    const str = content + path;\n    \n    for (let i = 0; i < str.length; i++) {\n      const char = str.charCodeAt(i);\n      hash = ((hash << 5) - hash) + char;\n      hash = hash & hash; // \u8F6C\u6362\u4E3A32\u4F4D\u6574\u6570\n    }\n    \n    return hash.toString(36);\n  }\n\n  /**\n   * \u83B7\u53D6\u5143\u7D20\u7684 DOM \u8DEF\u5F84\n   * @param {Element} element - DOM \u5143\u7D20\n   * @returns {string}\n   */\n  getElementPath(element) {\n    const parts = [];\n    let current = element;\n    \n    while (current && current !== document.body) {\n      let selector = current.tagName.toLowerCase();\n      if (current.id) {\n        selector += `#${current.id}`;\n      } else if (current.className) {\n        const classes = current.className.toString().split(' ').slice(0, 2).join('.');\n        if (classes) selector += `.${classes}`;\n      }\n      parts.unshift(selector);\n      current = current.parentElement;\n    }\n    \n    return parts.join('>');\n  }\n\n  /**\n   * \u68C0\u67E5\u6307\u7EB9\u662F\u5426\u5DF2\u5904\u7406\n   * @param {string} fingerprint - \u5185\u5BB9\u6307\u7EB9\n   * @returns {boolean}\n   */\n  isProcessed(fingerprint) {\n    return this.processedFingerprints.has(fingerprint);\n  }\n\n  /**\n   * \u6807\u8BB0\u6307\u7EB9\u4E3A\u5DF2\u5904\u7406\n   * @param {string} fingerprint - \u5185\u5BB9\u6307\u7EB9\n   */\n  markProcessed(fingerprint) {\n    this.processedFingerprints.add(fingerprint);\n  }\n\n  /**\n   * \u6E05\u9664\u5DF2\u5904\u7406\u7684\u6307\u7EB9\n   */\n  clearProcessed() {\n    this.processedFingerprints.clear();\n  }\n\n  /**\n   * \u83B7\u53D6\u5DF2\u5904\u7406\u7684\u6307\u7EB9\u6570\u91CF\n   * @returns {number}\n   */\n  getProcessedCount() {\n    return this.processedFingerprints.size;\n  }\n\n  /**\n   * \u83B7\u53D6\u9875\u9762\u5206\u6BB5\n   * @param {Element} root - \u6839\u5143\u7D20\n   * @param {object} options - \u9009\u9879\n   * @returns {Array} - \u5206\u6BB5\u6570\u7EC4\n   */\n  getPageSegments(root = document.body, options = {}) {\n    const { viewportOnly = false, margin = 300 } = options;\n    const segments = [];\n    \n    // \u5982\u679C\u53EA\u5904\u7406\u89C6\u53E3\u5185\u5BB9\uFF0C\u83B7\u53D6\u89C6\u53E3\u8303\u56F4\n    let viewportTop = 0;\n    let viewportBottom = Infinity;\n    \n    if (viewportOnly) {\n      viewportTop = window.scrollY - margin;\n      viewportBottom = window.scrollY + window.innerHeight + margin;\n    }\n\n    // \u83B7\u53D6\u6240\u6709\u6F5C\u5728\u7684\u6587\u672C\u5BB9\u5668\n    const containers = this.findTextContainers(root);\n\n    for (const container of containers) {\n      // \u89C6\u53E3\u68C0\u67E5\n      if (viewportOnly) {\n        const rect = container.getBoundingClientRect();\n        const elementTop = rect.top + window.scrollY;\n        const elementBottom = rect.bottom + window.scrollY;\n        \n        if (elementBottom < viewportTop || elementTop > viewportBottom) {\n          continue;\n        }\n      }\n\n      // \u83B7\u53D6\u6587\u672C\u5185\u5BB9\n      const text = this.getTextContent(container);\n      \n      if (!text || text.length < this.minSegmentLength) {\n        continue;\n      }\n\n      // \u68C0\u67E5\u662F\u5426\u4E3A\u4EE3\u7801\n      if (isCodeText(text)) {\n        continue;\n      }\n\n      // \u751F\u6210\u6307\u7EB9\u5E76\u68C0\u67E5\u662F\u5426\u5DF2\u5904\u7406\n      const path = this.getElementPath(container);\n      const fingerprint = this.generateFingerprint(text, path);\n      \n      if (this.isProcessed(fingerprint)) {\n        continue;\n      }\n\n      segments.push({\n        element: container,\n        text: text.slice(0, this.maxSegmentLength),\n        fingerprint,\n        path\n      });\n    }\n\n    return segments;\n  }\n\n  /**\n   * \u67E5\u627E\u6587\u672C\u5BB9\u5668\u5143\u7D20\n   * @param {Element} root - \u6839\u5143\u7D20\n   * @returns {Element[]}\n   */\n  findTextContainers(root) {\n    const containers = [];\n    const blockTags = ['P', 'DIV', 'ARTICLE', 'SECTION', 'LI', 'TD', 'TH', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'SPAN', 'BLOCKQUOTE'];\n    \n    const walker = document.createTreeWalker(\n      root,\n      NodeFilter.SHOW_ELEMENT,\n      {\n        acceptNode: (node) => {\n          if (this.shouldSkipNode(node)) {\n            return NodeFilter.FILTER_REJECT;\n          }\n          \n          if (blockTags.includes(node.tagName)) {\n            return NodeFilter.FILTER_ACCEPT;\n          }\n          \n          return NodeFilter.FILTER_SKIP;\n        }\n      }\n    );\n\n    let node;\n    while (node = walker.nextNode()) {\n      // \u68C0\u67E5\u662F\u5426\u6709\u76F4\u63A5\u6587\u672C\u5185\u5BB9\n      const hasDirectText = Array.from(node.childNodes).some(\n        child => child.nodeType === Node.TEXT_NODE && child.textContent.trim().length > 10\n      );\n      \n      if (hasDirectText) {\n        containers.push(node);\n      }\n    }\n\n    return containers;\n  }\n\n  /**\n   * \u83B7\u53D6\u5143\u7D20\u7684\u7EAF\u6587\u672C\u5185\u5BB9\uFF08\u6392\u9664\u5B50\u5143\u7D20\u4E2D\u7684\u4EE3\u7801\u7B49\uFF09\n   * @param {Element} element - DOM \u5143\u7D20\n   * @returns {string}\n   */\n  getTextContent(element) {\n    const texts = [];\n    \n    const walker = document.createTreeWalker(\n      element,\n      NodeFilter.SHOW_TEXT,\n      {\n        acceptNode: (node) => {\n          if (this.shouldSkipNode(node.parentElement)) {\n            return NodeFilter.FILTER_REJECT;\n          }\n          const text = node.textContent.trim();\n          if (text.length > 0 && !isCodeText(text)) {\n            return NodeFilter.FILTER_ACCEPT;\n          }\n          return NodeFilter.FILTER_REJECT;\n        }\n      }\n    );\n\n    let node;\n    while (node = walker.nextNode()) {\n      texts.push(node.textContent);\n    }\n\n    return texts.join(' ').replace(/\\s+/g, ' ').trim();\n  }\n\n  /**\n   * \u83B7\u53D6\u89C6\u53E3\u5185\u7684\u5206\u6BB5\n   * @param {number} margin - \u89C6\u53E3\u8FB9\u7F18\u5916\u7684\u5904\u7406\u8303\u56F4\n   * @returns {Array}\n   */\n  getViewportSegments(margin = 300) {\n    return this.getPageSegments(document.body, { viewportOnly: true, margin });\n  }\n}\n\n// \u5BFC\u51FA\u5355\u4F8B\nexport const contentSegmenter = new ContentSegmenter();\nexport default contentSegmenter;\n\n", "/**\n * VocabMeld \u6587\u672C\u66FF\u6362\u5668\u6A21\u5757\n * \u4F7F\u7528 Range API \u7CBE\u786E\u66FF\u6362\u6587\u672C\u8282\u70B9\n */\n\nimport { SKIP_TAGS, SKIP_CLASSES } from '../config/constants.js';\n\n/**\n * \u6587\u672C\u66FF\u6362\u5668\u7C7B\n */\nclass TextReplacer {\n  constructor() {\n    this.config = null;\n  }\n\n  /**\n   * \u8BBE\u7F6E\u914D\u7F6E\n   * @param {object} config - \u914D\u7F6E\u5BF9\u8C61\n   */\n  setConfig(config) {\n    this.config = config;\n  }\n\n  /**\n   * \u83B7\u53D6\u5143\u7D20\u5185\u7684\u6240\u6709\u6587\u672C\u8282\u70B9\uFF08\u5E26\u8FC7\u6EE4\uFF09\n   * @param {Element} element - DOM \u5143\u7D20\n   * @returns {Text[]}\n   */\n  getTextNodes(element) {\n    const nodes = [];\n    const walker = document.createTreeWalker(element, NodeFilter.SHOW_TEXT, {\n      acceptNode: (node) => {\n        const parent = node.parentElement;\n        if (!parent) return NodeFilter.FILTER_REJECT;\n\n        if (parent.classList?.contains('vocabmeld-translated')) {\n          return NodeFilter.FILTER_REJECT;\n        }\n\n        if (SKIP_TAGS.includes(parent.tagName)) return NodeFilter.FILTER_REJECT;\n\n        const classList = parent.className?.toString() || '';\n        if (SKIP_CLASSES.some(cls => classList.includes(cls) && cls !== 'vocabmeld-translated')) {\n          return NodeFilter.FILTER_REJECT;\n        }\n\n        try {\n          const style = window.getComputedStyle(parent);\n          if (style.display === 'none' || style.visibility === 'hidden') return NodeFilter.FILTER_REJECT;\n        } catch (e) {}\n\n        if (parent.isContentEditable) return NodeFilter.FILTER_REJECT;\n\n        const text = node.textContent.trim();\n        if (text.length === 0) return NodeFilter.FILTER_REJECT;\n\n        return NodeFilter.FILTER_ACCEPT;\n      }\n    });\n\n    let node;\n    while (node = walker.nextNode()) {\n      nodes.push(node);\n    }\n    return nodes;\n  }\n\n  /**\n   * \u521B\u5EFA\u66FF\u6362\u5143\u7D20\n   * @param {string} original - \u539F\u8BCD\n   * @param {string} translation - \u7FFB\u8BD1\n   * @param {string} phonetic - \u97F3\u6807\n   * @param {string} difficulty - \u96BE\u5EA6\n   * @param {string} partOfSpeech - \u8BCD\u6027\n   * @param {string} shortDefinition - \u7B80\u77ED\u5B9A\u4E49\n   * @param {string} sourceLang - \u6E90\u8BED\u8A00\n   * @param {string} example - \u4F8B\u53E5\n   * @returns {HTMLElement}\n   */\n  createReplacementElement(original, translation, phonetic, difficulty, partOfSpeech = '', shortDefinition = '', sourceLang = '', example = '') {\n    const wrapper = document.createElement('span');\n    wrapper.className = 'vocabmeld-translated';\n    wrapper.setAttribute('data-original', original);\n    wrapper.setAttribute('data-translation', translation);\n    wrapper.setAttribute('data-phonetic', phonetic || '');\n    wrapper.setAttribute('data-difficulty', difficulty || 'B1');\n    wrapper.setAttribute('data-part-of-speech', partOfSpeech || '');\n    wrapper.setAttribute('data-short-definition', shortDefinition || '');\n    wrapper.setAttribute('data-source-lang', sourceLang || '');\n    wrapper.setAttribute('data-example', example || '');\n\n    const style = this.config?.translationStyle || 'original-translation';\n    wrapper.setAttribute('data-style', style);\n    let innerHTML = '';\n\n    switch (style) {\n      case 'translation-only':\n        innerHTML = `<span class=\"vocabmeld-word\">${translation}</span>`;\n        break;\n      case 'original-translation':\n        innerHTML = `<span class=\"vocabmeld-original\">${original}</span><span class=\"vocabmeld-word\">(${translation})</span>`;\n        break;\n      case 'translation-original':\n      default:\n        innerHTML = `<span class=\"vocabmeld-word\">${translation}</span><span class=\"vocabmeld-original\">(${original})</span>`;\n        break;\n    }\n\n    wrapper.innerHTML = innerHTML;\n    return wrapper;\n  }\n\n  /**\n   * \u5728\u5143\u7D20\u4E2D\u67E5\u627E\u5E76\u66FF\u6362\u8BCD\u6C47\n   * @param {Element} element - DOM \u5143\u7D20\n   * @param {Array} replacements - \u66FF\u6362\u9879 [{ original, translation, phonetic, difficulty, partOfSpeech, shortDefinition, position, sourceLang, example }]\n   * @returns {number} - \u66FF\u6362\u6570\u91CF\n   */\n  applyReplacements(element, replacements) {\n    if (!element || !replacements?.length) return 0;\n\n    let count = 0;\n\n    // \u6309\u4F4D\u7F6E\u6392\u5E8F\u66FF\u6362\u9879\uFF08\u4ECE\u540E\u5F80\u524D\u66FF\u6362\uFF0C\u907F\u514D\u4F4D\u7F6E\u504F\u79FB\uFF09\n    const sortedReplacements = [...replacements].sort((a, b) => (b.position || 0) - (a.position || 0));\n\n    for (const replacement of sortedReplacements) {\n      const { original, translation, phonetic, difficulty, partOfSpeech = '', shortDefinition = '', sourceLang = '', example = '' } = replacement;\n\n      // \u8DF3\u8FC7\u539F\u8BCD\u548C\u7FFB\u8BD1\u76F8\u540C\u7684\u60C5\u51B5\uFF08\u82F1\u6587\uFF09\n      const isEnglishLike = /^[a-zA-Z]+$/.test(original);\n      if (isEnglishLike && original.toLowerCase() === translation.toLowerCase()) {\n        continue;\n      }\n\n      const lowerOriginal = original.toLowerCase();\n\n      // \u6BCF\u6B21\u90FD\u91CD\u65B0\u83B7\u53D6\u6587\u672C\u8282\u70B9\uFF08\u56E0\u4E3A DOM \u53EF\u80FD\u5DF2\u66F4\u6539\uFF09\n      const textNodes = this.getTextNodes(element);\n\n      for (let i = 0; i < textNodes.length; i++) {\n        const textNode = textNodes[i];\n\n        if (!textNode.parentElement || !element.contains(textNode)) {\n          continue;\n        }\n\n        const text = textNode.textContent;\n        const lowerText = text.toLowerCase();\n\n        if (!lowerText.includes(lowerOriginal)) continue;\n\n        // \u4F7F\u7528\u8BCD\u8FB9\u754C\u6B63\u5219\u5339\u914D\n        const escapedOriginal = original.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n        const regex = new RegExp(`(^|[^\\\\w\\\\u4e00-\\\\u9fff])${escapedOriginal}([^\\\\w\\\\u4e00-\\\\u9fff]|$)`, 'i');\n\n        let match = regex.exec(text);\n        let startIndex = match ? match.index + match[1].length : text.toLowerCase().indexOf(lowerOriginal);\n\n        if (startIndex === -1) continue;\n\n        try {\n          const range = document.createRange();\n          range.setStart(textNode, startIndex);\n          range.setEnd(textNode, startIndex + original.length);\n\n          // \u9A8C\u8BC1\u8303\u56F4\u5185\u5BB9\n          const rangeContent = range.toString();\n          if (rangeContent.toLowerCase() !== lowerOriginal) continue;\n\n          // \u68C0\u67E5\u662F\u5426\u5DF2\u88AB\u66FF\u6362\n          let parent = textNode.parentElement;\n          let isAlreadyReplaced = false;\n          while (parent && parent !== element) {\n            if (parent.classList?.contains('vocabmeld-translated')) {\n              isAlreadyReplaced = true;\n              break;\n            }\n            parent = parent.parentElement;\n          }\n\n          if (isAlreadyReplaced) continue;\n\n          // \u521B\u5EFA\u5E76\u63D2\u5165\u66FF\u6362\u5143\u7D20\n          const wrapper = this.createReplacementElement(original, translation, phonetic, difficulty, partOfSpeech, shortDefinition, sourceLang, example);\n          range.deleteContents();\n          range.insertNode(wrapper);\n          count++;\n\n          break; // \u6BCF\u4E2A\u66FF\u6362\u9879\u53EA\u66FF\u6362\u4E00\u6B21\n        } catch (e) {\n          console.error('[VocabMeld] Replacement error:', e, original);\n        }\n      }\n    }\n\n    // \u6807\u8BB0\u5143\u7D20\u5DF2\u5904\u7406\n    if (count > 0) element.setAttribute('data-vocabmeld-processed', 'true');\n    return count;\n  }\n\n  /**\n   * \u6062\u590D\u66FF\u6362\u7684\u8BCD\u6C47\u4E3A\u539F\u6587\n   * @param {Element} element - \u66FF\u6362\u5143\u7D20\n   */\n  restoreOriginal(element) {\n    if (!element.classList?.contains('vocabmeld-translated')) return;\n    const original = element.getAttribute('data-original');\n    const textNode = document.createTextNode(original);\n    element.parentNode.replaceChild(textNode, element);\n  }\n\n  /**\n   * \u6062\u590D\u9875\u9762\u4E0A\u6240\u6709\u66FF\u6362\u7684\u8BCD\u6C47\n   * @param {Element} root - \u6839\u5143\u7D20\n   */\n  restoreAll(root = document.body) {\n    root.querySelectorAll('.vocabmeld-translated').forEach(el => this.restoreOriginal(el));\n    root.querySelectorAll('[data-vocabmeld-processed]').forEach(el => {\n      el.removeAttribute('data-vocabmeld-processed');\n    });\n  }\n}\n\n// \u5BFC\u51FA\u5355\u4F8B\nexport const textReplacer = new TextReplacer();\nexport default textReplacer;\n", "import { CEFR_LEVELS, INTENSITY_CONFIG, SKIP_TAGS, SKIP_CLASSES, CACHE_MAX_SIZE } from './config/constants.js';\nimport { initLanguageDetector, detectLanguage } from './utils/language-detector.js';\nimport { isDifficultyCompatible, isCodeText, isNonLearningWord } from './utils/word-filters.js';\nimport { TooltipManager } from './ui/tooltip.js';\nimport { showToast } from './ui/toast.js';\nimport { apiService } from './services/api-service.js';\nimport { contentSegmenter } from './services/content-segmenter.js';\nimport { textReplacer } from './services/text-replacer.js';\n\n// ============ \u72B6\u6001\u7BA1\u7406 ============\nlet config = null;\nlet isProcessing = false;\nlet wordCache = new Map();\nconst tooltipManager = new TooltipManager();\n\n// ============ \u914D\u7F6E\u52A0\u8F7D ============\nasync function loadConfig() {\n  return new Promise((resolve) => {\n    chrome.storage.sync.get(null, (result) => {\n      config = {\n        apiEndpoint: result.apiEndpoint || 'https://api.deepseek.com/chat/completions',\n        apiKey: result.apiKey || '',\n        modelName: result.modelName || 'deepseek-chat',\n        nativeLanguage: result.nativeLanguage || 'zh-CN',\n        targetLanguage: result.targetLanguage || 'en',\n        difficultyLevel: result.difficultyLevel || 'B1',\n        intensity: result.intensity || 'medium',\n        autoProcess: result.autoProcess ?? false,\n        showPhonetic: result.showPhonetic ?? true,\n        pronunciationProvider: result.pronunciationProvider || 'wiktionary',\n        youdaoPronunciationType: Number(result.youdaoPronunciationType) === 1 ? 1 : 2,\n        translationStyle: result.translationStyle || 'original-translation',\n        enabled: result.enabled ?? true,\n        blacklist: result.blacklist || [],\n        whitelist: result.whitelist || [],\n        learnedWords: result.learnedWords || [],\n        memorizeList: result.memorizeList || []\n      };\n      tooltipManager.setConfig(config);\n      textReplacer.setConfig(config);\n      resolve(config);\n    });\n  });\n}\n\nasync function loadWordCache() {\n  return new Promise((resolve) => {\n    chrome.storage.local.get('vocabmeld_word_cache', (result) => {\n      const cached = result.vocabmeld_word_cache;\n      if (cached && Array.isArray(cached)) {\n        cached.forEach(item => {\n          wordCache.set(item.key, {\n            translation: item.translation,\n            phonetic: item.phonetic,\n            difficulty: item.difficulty,\n            partOfSpeech: item.partOfSpeech || '',\n            shortDefinition: item.shortDefinition || '',\n            example: item.example || ''\n          });\n        });\n      }\n      resolve(wordCache);\n    });\n  });\n}\n\nasync function saveWordCache() {\n  const data = [];\n  for (const [key, value] of wordCache) {\n    data.push({ key, ...value });\n  }\n  return new Promise((resolve, reject) => {\n    chrome.storage.local.set({ vocabmeld_word_cache: data }, () => {\n      if (chrome.runtime.lastError) {\n        if (isContextInvalidated(chrome.runtime.lastError)) {\n          return resolve();\n        }\n        console.error('[VocabMeld] Failed to save cache:', chrome.runtime.lastError);\n        return reject(chrome.runtime.lastError);\n      }\n      resolve();\n    });\n  });\n}\n\nfunction isContextInvalidated(error) {\n  const message = (error && error.message) || String(error || '');\n  return message.includes('Extension context invalidated');\n}\n\nasync function updateStats(stats) {\n  return new Promise((resolve) => {\n    chrome.storage.sync.get(['totalWords', 'todayWords', 'lastResetDate', 'cacheHits', 'cacheMisses'], (current) => {\n      if (chrome.runtime.lastError) {\n        if (!isContextInvalidated(chrome.runtime.lastError)) {\n          console.warn('[VocabMeld] Stats read failed:', chrome.runtime.lastError);\n        }\n        return resolve(null);\n      }\n\n      const today = new Date().toISOString().split('T')[0];\n      if (current.lastResetDate !== today) {\n        current.todayWords = 0;\n        current.lastResetDate = today;\n      }\n      const updated = {\n        totalWords: (current.totalWords || 0) + (stats.newWords || 0),\n        todayWords: (current.todayWords || 0) + (stats.newWords || 0),\n        lastResetDate: today,\n        cacheHits: (current.cacheHits || 0) + (stats.cacheHits || 0),\n        cacheMisses: (current.cacheMisses || 0) + (stats.cacheMisses || 0)\n      };\n\n      chrome.storage.sync.set(updated, () => {\n        if (chrome.runtime.lastError) {\n          if (!isContextInvalidated(chrome.runtime.lastError)) {\n            console.warn('[VocabMeld] Stats write failed:', chrome.runtime.lastError);\n          }\n          return resolve(null);\n        }\n        resolve(updated);\n      });\n    });\n  });\n}\n\nasync function addToWhitelist(original, translation, difficulty) {\n  const whitelist = config.learnedWords || [];\n  const exists = whitelist.some(w => w.original === original || w.word === translation);\n  if (!exists) {\n    whitelist.push({\n      original,\n      word: translation,\n      addedAt: Date.now(),\n      difficulty: difficulty || 'B1'\n    });\n    config.learnedWords = whitelist;\n    await new Promise(resolve => chrome.storage.sync.set({ learnedWords: whitelist }, resolve));\n  }\n}\n\nasync function addToMemorizeList(word) {\n  if (!word || !word.trim()) {\n    console.warn('[VocabMeld] Invalid word for memorize list:', word);\n    return;\n  }\n\n  const trimmedWord = word.trim();\n  const list = config.memorizeList || [];\n  const exists = list.some(w => w.word === trimmedWord);\n\n  if (!exists) {\n    list.push({ word: trimmedWord, addedAt: Date.now() });\n    config.memorizeList = list;\n    await new Promise(resolve => chrome.storage.sync.set({ memorizeList: list }, resolve));\n\n    if (!config) {\n      await loadConfig();\n    }\n\n    if (!config.enabled) {\n      showToast(`\"${trimmedWord}\" \u5DF2\u6DFB\u52A0\u5230\u8BB0\u5FC6\u5217\u8868`);\n      return;\n    }\n\n    try {\n      const count = await processSpecificWords([trimmedWord]);\n\n      if (count > 0) {\n        showToast(`\"${trimmedWord}\" \u5DF2\u6DFB\u52A0\u5230\u8BB0\u5FC6\u5217\u8868\u5E76\u7FFB\u8BD1`);\n      } else {\n        try {\n          await translateSpecificWords([trimmedWord]);\n          showToast(`\"${trimmedWord}\" \u5DF2\u6DFB\u52A0\u5230\u8BB0\u5FC6\u5217\u8868`);\n        } catch (error) {\n          console.error('[VocabMeld] Error translating word:', trimmedWord, error);\n          showToast(`\"${trimmedWord}\" \u5DF2\u6DFB\u52A0\u5230\u8BB0\u5FC6\u5217\u8868`);\n        }\n      }\n    } catch (error) {\n      console.error('[VocabMeld] Error processing word:', trimmedWord, error);\n      showToast(`\"${trimmedWord}\" \u5DF2\u6DFB\u52A0\u5230\u8BB0\u5FC6\u5217\u8868`);\n    }\n  } else {\n    showToast(`\"${trimmedWord}\" \u5DF2\u5728\u8BB0\u5FC6\u5217\u8868\u4E2D`);\n  }\n}\n\n// ============ DOM \u5904\u7406\uFF08\u4F7F\u7528 content-segmenter \u670D\u52A1\uFF09 ============\n\nfunction getPageSegments(viewportOnly = false, margin = 300) {\n  return contentSegmenter.getPageSegments(document.body, { viewportOnly, margin });\n}\n\nfunction getTextContent(element) {\n  return contentSegmenter.getTextContent(element);\n}\n\nfunction getElementPath(element) {\n  return contentSegmenter.getElementPath(element);\n}\n\nfunction generateFingerprint(text, path = '') {\n  return contentSegmenter.generateFingerprint(text, path);\n}\n\n// ============ \u6587\u672C\u66FF\u6362\uFF08\u4F7F\u7528 text-replacer \u670D\u52A1\uFF09 ============\n\nfunction applyReplacements(element, replacements) {\n  return textReplacer.applyReplacements(element, replacements);\n}\n\nfunction restoreOriginal(element) {\n  return textReplacer.restoreOriginal(element);\n}\n\nfunction restoreAll() {\n  textReplacer.restoreAll();\n  contentSegmenter.clearProcessed();\n}\n\n// ============ \u7FFB\u8BD1\u903B\u8F91\uFF08\u8C03\u7528 api-service\uFF09 ============\nasync function translateText(text) {\n  if (wordCache.size === 0) {\n    await loadWordCache();\n  }\n\n  return await apiService.translateText(text, config, wordCache, updateStats, saveWordCache);\n}\n\nasync function translateSpecificWords(targetWords) {\n  if (wordCache.size === 0) {\n    await loadWordCache();\n  }\n\n  return await apiService.translateSpecificWords(targetWords, config, wordCache, updateStats, saveWordCache);\n}\n\nasync function processSpecificWords(targetWords) {\n  if (!config?.enabled || !targetWords?.length) {\n    return 0;\n  }\n\n  const targetWordSet = new Set(targetWords.map(w => w.toLowerCase()));\n  let processed = 0;\n\n  // \u68C0\u67E5\u5DF2\u7FFB\u8BD1\u7684\u5143\u7D20\n  const alreadyTranslated = [];\n  document.querySelectorAll('.vocabmeld-translated').forEach(el => {\n    const original = el.getAttribute('data-original');\n    if (original && targetWordSet.has(original.toLowerCase())) {\n      alreadyTranslated.push(original.toLowerCase());\n    }\n  });\n\n  // \u67E5\u627E\u5305\u542B\u76EE\u6807\u5355\u8BCD\u7684\u6587\u672C\u8282\u70B9\n  const textNodes = [];\n  const walker = document.createTreeWalker(document.body, NodeFilter.SHOW_TEXT, {\n    acceptNode: (node) => {\n      const parent = node.parentElement;\n      if (!parent) return NodeFilter.FILTER_REJECT;\n\n      if (SKIP_TAGS.includes(parent.tagName)) return NodeFilter.FILTER_REJECT;\n\n      const classList = parent.className?.toString() || '';\n      if (SKIP_CLASSES.some(cls => classList.includes(cls) && cls !== 'vocabmeld-translated')) {\n        return NodeFilter.FILTER_REJECT;\n      }\n\n      try {\n        const style = window.getComputedStyle(parent);\n        if (style.display === 'none' || style.visibility === 'hidden') return NodeFilter.FILTER_REJECT;\n      } catch (e) {}\n\n      if (parent.isContentEditable) return NodeFilter.FILTER_REJECT;\n\n      const text = node.textContent.trim();\n      if (text.length === 0) return NodeFilter.FILTER_REJECT;\n\n      if (isCodeText(text)) return NodeFilter.FILTER_REJECT;\n\n      return NodeFilter.FILTER_ACCEPT;\n    }\n  });\n\n  let node;\n  while (node = walker.nextNode()) {\n    const text = node.textContent;\n    const words = text.match(/\\b[a-zA-Z]{5,}\\b/g) || [];\n    const chineseWords = text.match(/[\\u4e00-\\u9fff]{2,4}/g) || [];\n    const allWords = [...words, ...chineseWords];\n\n    const containsTarget = allWords.some(word => {\n      const lowerWord = word.toLowerCase();\n      return targetWordSet.has(lowerWord) && !alreadyTranslated.includes(lowerWord);\n    });\n\n    if (containsTarget) {\n      textNodes.push(node);\n    }\n  }\n\n  if (textNodes.length === 0) {\n    return 0;\n  }\n\n  // \u6784\u9020\u5305\u542B\u76EE\u6807\u5355\u8BCD\u7684\u6587\u672C\u6BB5\u843D\n  const segments = [];\n  for (const textNode of textNodes) {\n    const container = textNode.parentElement;\n    if (!container) continue;\n\n    const containerText = getTextContent(container);\n\n    let contextText = containerText;\n    if (contextText.length < 30) {\n      const grandParent = container.parentElement;\n      if (grandParent) {\n        contextText = getTextContent(grandParent);\n      }\n    }\n\n    if (contextText.length >= 10) {\n      const path = getElementPath(container);\n      const fingerprint = generateFingerprint(contextText, path);\n\n      const isProcessed = container.hasAttribute('data-vocabmeld-processed') ||\n                         container.closest('[data-vocabmeld-processed]');\n\n      segments.push({\n        element: container,\n        text: contextText,\n        fingerprint: fingerprint,\n        isProcessed: !!isProcessed\n      });\n    }\n  }\n\n  // \u53BB\u91CD\n  const uniqueSegments = segments.filter((segment, index, self) =>\n    index === self.findIndex(s => s.fingerprint === segment.fingerprint)\n  );\n\n  // \u83B7\u53D6\u76EE\u6807\u5355\u8BCD\u7684\u7FFB\u8BD1\n  const translations = await translateSpecificWords(targetWords);\n\n  if (translations.length === 0) {\n    return 0;\n  }\n\n  // \u5E94\u7528\u5230\u6BCF\u4E2A\u6BB5\u843D\n  for (const segment of uniqueSegments) {\n    const replacements = translations.map(translation => {\n      const position = segment.text.toLowerCase().indexOf(translation.original.toLowerCase());\n      return {\n        original: translation.original,\n        translation: translation.translation,\n        phonetic: translation.phonetic,\n        difficulty: translation.difficulty,\n        partOfSpeech: translation.partOfSpeech || '',\n        shortDefinition: translation.shortDefinition || '',\n        position: position >= 0 ? position : 0\n      };\n    }).filter(r => r.position >= 0 || segment.text.toLowerCase().includes(r.original.toLowerCase()));\n\n    if (replacements.length === 0) continue;\n\n    const count = applyReplacements(segment.element, replacements);\n    processed += count;\n  }\n\n  return processed;\n}\n\nasync function processPage(viewportOnly = false) {\n  if (isProcessing) return { processed: 0, skipped: true };\n  if (!config?.enabled) return { processed: 0, disabled: true };\n\n  const hostname = window.location.hostname;\n  if (config.blacklist?.some(domain => hostname.includes(domain))) {\n    return { processed: 0, blacklisted: true };\n  }\n\n  if (wordCache.size === 0) {\n    await loadWordCache();\n  }\n\n  isProcessing = true;\n  let processed = 0, errors = 0;\n\n  try {\n    // \u9996\u5148\u5904\u7406\u8BB0\u5FC6\u5217\u8868\u4E2D\u7684\u5355\u8BCD\n    const memorizeWords = (config.memorizeList || []).map(w => w.word).filter(w => w && w.trim());\n    if (memorizeWords.length > 0 && !viewportOnly) {\n      try {\n        const memorizeCount = await processSpecificWords(memorizeWords);\n        processed += memorizeCount;\n      } catch (e) {\n        console.error('[VocabMeld] Error processing memorize list:', e);\n        errors++;\n      }\n    }\n\n    const segments = getPageSegments(viewportOnly);\n    const whitelistWords = new Set((config.learnedWords || []).map(w => w.original.toLowerCase()));\n\n    // \u9884\u5904\u7406\uFF1A\u8FC7\u6EE4\u6709\u6548\u7684 segments\n    const validSegments = [];\n    for (const segment of segments) {\n      let text = segment.text;\n      for (const word of whitelistWords) {\n        const regex = new RegExp(`\\\\b${word}\\\\b`, 'gi');\n        text = text.replace(regex, '');\n      }\n      if (text.trim().length >= 30) {\n        validSegments.push({ ...segment, filteredText: text });\n      }\n    }\n\n    // \u5E76\u884C\u5904\u7406\u5355\u4E2A segment\n    const MAX_CONCURRENT = 3;\n\n    async function processSegment(segment) {\n      const el = segment.element;\n      try {\n        el.classList.add('vocabmeld-processing');\n\n        const result = await translateText(segment.filteredText);\n\n        // \u5148\u5E94\u7528\u7F13\u5B58\u7ED3\u679C\uFF08\u7ACB\u5373\u663E\u793A\uFF09\n        let immediateCount = 0;\n        if (result.immediate?.length) {\n          const filtered = result.immediate.filter(r => !whitelistWords.has(r.original.toLowerCase()));\n          immediateCount = applyReplacements(el, filtered);\n          contentSegmenter.markProcessed(segment.fingerprint);\n        }\n\n        // \u5982\u679C\u6709\u5F02\u6B65\u7ED3\u679C\uFF0C\u7B49\u5F85\u5E76\u66F4\u65B0\n        if (result.async) {\n          result.async.then(async (asyncReplacements) => {\n            try {\n              if (asyncReplacements?.length) {\n                // \u83B7\u53D6\u5DF2\u66FF\u6362\u7684\u8BCD\u6C47\uFF0C\u907F\u514D\u91CD\u590D\n                const alreadyReplaced = new Set();\n                el.querySelectorAll('.vocabmeld-translated').forEach(transEl => {\n                  const original = transEl.getAttribute('data-original');\n                  if (original) {\n                    alreadyReplaced.add(original.toLowerCase());\n                  }\n                });\n\n                const filtered = asyncReplacements.filter(r =>\n                  !whitelistWords.has(r.original.toLowerCase()) &&\n                  !alreadyReplaced.has(r.original.toLowerCase())\n                );\n\n                if (filtered.length > 0) {\n                  applyReplacements(el, filtered);\n                }\n              }\n            } finally {\n              el.classList.remove('vocabmeld-processing');\n            }\n          }).catch(error => {\n            console.error('[VocabMeld] Async translation error:', error);\n            el.classList.remove('vocabmeld-processing');\n          });\n        } else {\n          el.classList.remove('vocabmeld-processing');\n        }\n\n        return { count: immediateCount, error: false };\n      } catch (e) {\n        console.error('[VocabMeld] Segment error:', e);\n        el.classList.remove('vocabmeld-processing');\n        return { count: 0, error: true };\n      }\n    }\n\n    // \u5206\u6279\u5E76\u884C\u5904\u7406\n    for (let i = 0; i < validSegments.length; i += MAX_CONCURRENT) {\n      const batch = validSegments.slice(i, i + MAX_CONCURRENT);\n      const results = await Promise.all(batch.map(processSegment));\n\n      for (const result of results) {\n        processed += result.count;\n        if (result.error) errors++;\n      }\n    }\n\n    return { processed, errors };\n  } finally {\n    isProcessing = false;\n  }\n}\n\n// ============ \u4E8B\u4EF6\u5904\u7406 ============\nfunction setupEventListeners() {\n  // \u60AC\u505C\u663E\u793A\u63D0\u793A\n  document.addEventListener('mouseover', (e) => {\n    const target = e.target.closest('.vocabmeld-translated');\n    if (target) {\n      tooltipManager.show(target);\n    }\n    if (e.target.closest('.vocabmeld-tooltip')) {\n      tooltipManager.cancelHide();\n    }\n  });\n\n  document.addEventListener('mouseout', (e) => {\n    const target = e.target.closest('.vocabmeld-translated');\n    const relatedTarget = e.relatedTarget;\n\n    if (target &&\n        !relatedTarget?.closest('.vocabmeld-translated') &&\n        !relatedTarget?.closest('.vocabmeld-tooltip')) {\n      tooltipManager.hide();\n    }\n  });\n\n  document.addEventListener('mouseout', (e) => {\n    if (e.target.closest('.vocabmeld-tooltip') &&\n        !e.relatedTarget?.closest('.vocabmeld-tooltip') &&\n        !e.relatedTarget?.closest('.vocabmeld-translated')) {\n      tooltipManager.hide();\n    }\n  });\n\n  // \u5904\u7406 tooltip \u6309\u94AE\u70B9\u51FB\u4E8B\u4EF6\n  document.addEventListener('click', async (e) => {\n    const actionBtn = e.target.closest('.vocabmeld-action-btn');\n    const currentElement = tooltipManager.getCurrentElement();\n\n    if (actionBtn && currentElement) {\n      e.preventDefault();\n      e.stopPropagation();\n\n      const action = actionBtn.getAttribute('data-action');\n      const original = currentElement.getAttribute('data-original');\n      const translation = currentElement.getAttribute('data-translation');\n      const difficulty = currentElement.getAttribute('data-difficulty') || 'B1';\n\n      switch (action) {\n        case 'speak':\n          await tooltipManager.playAudio(currentElement);\n          break;\n        case 'memorize':\n          await addToMemorizeList(original);\n          showToast(`\"${original}\" \u5DF2\u6DFB\u52A0\u5230\u8BB0\u5FC6\u5217\u8868`);\n          break;\n        case 'learned':\n          await addToWhitelist(original, translation, difficulty);\n          restoreOriginal(currentElement);\n          tooltipManager.hide(true);\n          showToast(`\"${original}\" \u5DF2\u6807\u8BB0\u4E3A\u5DF2\u5B66\u4F1A`);\n          break;\n      }\n    }\n  });\n\n  // \u6EDA\u52A8\u5904\u7406\n  const handleScroll = debounce(() => {\n    if (config?.autoProcess && config?.enabled) {\n      processPage(true);\n    }\n  }, 500);\n  window.addEventListener('scroll', handleScroll, { passive: true });\n\n  // \u76D1\u542C\u914D\u7F6E\u53D8\u5316\n  chrome.storage.onChanged.addListener((changes, areaName) => {\n    if (areaName === 'sync') {\n      loadConfig().then(() => {\n        if (changes.enabled?.newValue === false) {\n          restoreAll();\n        }\n        if (changes.difficultyLevel || changes.intensity || changes.translationStyle) {\n          restoreAll();\n          if (config.enabled) {\n            processPage();\n          }\n        }\n        if (changes.memorizeList) {\n          const oldList = changes.memorizeList.oldValue || [];\n          const newList = changes.memorizeList.newValue || [];\n          const oldWords = new Set(oldList.map(w => w.word.toLowerCase()));\n          const newWords = newList\n            .filter(w => !oldWords.has(w.word.toLowerCase()))\n            .map(w => w.word);\n\n          if (newWords.length > 0 && config.enabled) {\n            setTimeout(() => {\n              processSpecificWords(newWords);\n            }, 200);\n          }\n        }\n      });\n    }\n  });\n\n  // \u76D1\u542C\u6765\u81EA popup/background \u7684\u6D88\u606F\n  chrome.runtime.onMessage.addListener((message, sender, sendResponse) => {\n    if (message.action === 'processPage') {\n      processPage().then(sendResponse);\n      return true;\n    }\n    if (message.action === 'restorePage') {\n      restoreAll();\n      sendResponse({ success: true });\n    }\n    if (message.action === 'processSpecificWords') {\n      const words = message.words || [];\n      if (words.length > 0) {\n        processSpecificWords(words).then(count => {\n          sendResponse({ success: true, count });\n        }).catch(error => {\n          console.error('[VocabMeld] Error processing specific words:', error);\n          sendResponse({ success: false, error: error.message });\n        });\n        return true;\n      } else {\n        sendResponse({ success: false, error: 'No words provided' });\n      }\n    }\n    if (message.action === 'getStatus') {\n      sendResponse({\n        processed: contentSegmenter.getProcessedCount(),\n        isProcessing,\n        enabled: config?.enabled\n      });\n    }\n  });\n}\n\nfunction debounce(func, wait) {\n  let timeout;\n  return (...args) => {\n    clearTimeout(timeout);\n    timeout = setTimeout(() => func.apply(this, args), wait);\n  };\n}\n\n// ============ \u521D\u59CB\u5316 ============\nasync function init() {\n  await loadConfig();\n  await loadWordCache();\n  await initLanguageDetector();\n\n  tooltipManager.createTooltip();\n  setupEventListeners();\n\n  if (config.autoProcess && config.enabled && config.apiKey) {\n    setTimeout(() => processPage(), 1000);\n  }\n\n  console.log('[VocabMeld] \u521D\u59CB\u5316\u5B8C\u6210 (\u6A21\u5757\u5316\u91CD\u6784\u7248)');\n}\n\n// \u542F\u52A8\nif (document.readyState === 'loading') {\n  document.addEventListener('DOMContentLoaded', init);\n} else {\n  init();\n}\n"],
  "mappings": "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",
  "names": ["config", "CEFR_LEVELS", "CEFR_LEVELS", "config", "node", "config", "node", "node"]
}
