<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sapling 设置</title>
  <link rel="stylesheet" href="css/options.css">
</head>
<body>
  <div class="options-container">
    <!-- 侧边栏 -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <img src="icons/icon48.png" alt="Sapling" class="sidebar-logo">
        <h1>Sapling</h1>
        <span class="version">v1.0.0</span>
      </div>
      <nav class="sidebar-nav">
        <a href="#api" class="nav-item active" data-section="api">
          <svg viewBox="0 0 24 24" width="20" height="20">
            <path fill="currentColor" d="M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1M12,5A3,3 0 0,1 15,8A3,3 0 0,1 12,11A3,3 0 0,1 9,8A3,3 0 0,1 12,5M17.13,17C15.92,18.85 14.11,20.24 12,20.92C9.89,20.24 8.08,18.85 6.87,17C6.53,16.5 6.24,16 6,15.47C6,13.82 8.71,12.47 12,12.47C15.29,12.47 18,13.79 18,15.47C17.76,16 17.47,16.5 17.13,17Z"/>
          </svg>
          API 配置
        </a>
        <a href="#learning" class="nav-item" data-section="learning">
          <svg viewBox="0 0 24 24" width="20" height="20">
            <path fill="currentColor" d="M12,3L1,9L12,15L21,10.09V17H23V9M5,13.18V17.18L12,21L19,17.18V13.18L12,17L5,13.18Z"/>
          </svg>
          学习偏好
        </a>
        <a href="#behavior" class="nav-item" data-section="behavior">
          <svg viewBox="0 0 24 24" width="20" height="20">
            <path fill="currentColor" d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"/>
          </svg>
          行为设置
        </a>
        <a href="#theme" class="nav-item" data-section="theme">
          <svg viewBox="0 0 24 24" width="20" height="20">
            <path fill="currentColor" d="M12,3A9,9 0 0,0 3,12C3,16.42 6.58,20 11,20H12C12.55,20 13,20.45 13,21C13,21.55 12.55,22 12,22H11C5.48,22 1,17.52 1,12A11,11 0 0,1 12,1A11,11 0 0,1 23,12C23,15.87 19.87,19 16,19H14.5C13.12,19 12,17.88 12,16.5C12,15.12 13.12,14 14.5,14H16C18.21,14 20,12.21 20,10A8,8 0 0,0 12,3M7.5,10A1.5,1.5 0 0,1 6,8.5A1.5,1.5 0 0,1 7.5,7A1.5,1.5 0 0,1 9,8.5A1.5,1.5 0 0,1 7.5,10M10.5,6.5A1.5,1.5 0 0,1 12,5A1.5,1.5 0 0,1 13.5,6.5A1.5,1.5 0 0,1 12,8A1.5,1.5 0 0,1 10.5,6.5M16.5,10A1.5,1.5 0 0,1 15,8.5A1.5,1.5 0 0,1 16.5,7A1.5,1.5 0 0,1 18,8.5A1.5,1.5 0 0,1 16.5,10M7.5,15A1.5,1.5 0 0,1 6,13.5A1.5,1.5 0 0,1 7.5,12A1.5,1.5 0 0,1 9,13.5A1.5,1.5 0 0,1 7.5,15Z"/>
          </svg>
          主题设置
        </a>
        <a href="#advanced" class="nav-item" data-section="advanced">
          <svg viewBox="0 0 24 24" width="20" height="20">
            <path fill="currentColor" d="M12,8A4,4 0 0,0 8,12A4,4 0 0,0 12,16A4,4 0 0,0 16,12A4,4 0 0,0 12,8M4.93,12.5C4.96,12.33 5,12.17 5,12C5,11.83 4.96,11.67 4.93,11.5L3.22,10.15C3.07,10.03 3.03,9.82 3.12,9.66L4.72,6.89C4.81,6.72 5,6.66 5.17,6.72L7.15,7.5C7.5,7.23 7.88,7 8.3,6.82L8.6,4.71C8.63,4.53 8.79,4.4 9,4.4H15C15.21,4.4 15.37,4.53 15.4,4.71L15.7,6.82C16.12,7 16.5,7.23 16.85,7.5L18.83,6.72C19,6.66 19.19,6.72 19.28,6.89L20.88,9.66C20.97,9.82 20.93,10.03 20.78,10.15L19.07,11.5C19.04,11.67 19,11.83 19,12C19,12.17 19.04,12.33 19.07,12.5L20.78,13.85C20.93,13.97 20.97,14.18 20.88,14.34L19.28,17.11C19.19,17.28 19,17.34 18.83,17.28L16.85,16.5C16.5,16.77 16.12,17 15.7,17.18L15.4,19.29C15.37,19.47 15.21,19.6 15,19.6H9C8.79,19.6 8.63,19.47 8.6,19.29L8.3,17.18C7.88,17 7.5,16.77 7.15,16.5L5.17,17.28C5,17.34 4.81,17.28 4.72,17.11L3.12,14.34C3.03,14.18 3.07,13.97 3.22,13.85L4.93,12.5Z"/>
          </svg>
          高级设置
        </a>
        <a href="#sites" class="nav-item" data-section="sites">
          <svg viewBox="0 0 24 24" width="20" height="20">
            <path fill="currentColor" d="M16.36,14C16.44,13.34 16.5,12.68 16.5,12C16.5,11.32 16.44,10.66 16.36,10H19.74C19.9,10.64 20,11.31 20,12C20,12.69 19.9,13.36 19.74,14M14.59,19.56C15.19,18.45 15.65,17.25 15.97,16H18.92C17.96,17.65 16.43,18.93 14.59,19.56M14.34,14H9.66C9.56,13.34 9.5,12.68 9.5,12C9.5,11.32 9.56,10.65 9.66,10H14.34C14.43,10.65 14.5,11.32 14.5,12C14.5,12.68 14.43,13.34 14.34,14M12,19.96C11.17,18.76 10.5,17.43 10.09,16H13.91C13.5,17.43 12.83,18.76 12,19.96M8,8H5.08C6.03,6.34 7.57,5.06 9.4,4.44C8.8,5.55 8.35,6.75 8,8M5.08,16H8C8.35,17.25 8.8,18.45 9.4,19.56C7.57,18.93 6.03,17.65 5.08,16M4.26,14C4.1,13.36 4,12.69 4,12C4,11.31 4.1,10.64 4.26,10H7.64C7.56,10.66 7.5,11.32 7.5,12C7.5,12.68 7.56,13.34 7.64,14M12,4.03C12.83,5.23 13.5,6.57 13.91,8H10.09C10.5,6.57 11.17,5.23 12,4.03M18.92,8H15.97C15.65,6.75 15.19,5.55 14.59,4.44C16.43,5.07 17.96,6.34 18.92,8M12,2C6.47,2 2,6.5 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"/>
          </svg>
          站点规则
        </a>
        <a href="#words" class="nav-item" data-section="words">
          <svg viewBox="0 0 24 24" width="20" height="20">
            <path fill="currentColor" d="M19,3H14.82C14.4,1.84 13.3,1 12,1C10.7,1 9.6,1.84 9.18,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3M12,3A1,1 0 0,1 13,4A1,1 0 0,1 12,5A1,1 0 0,1 11,4A1,1 0 0,1 12,3M7,7H17V5H19V19H5V5H7V7M7.5,13.5L9,12L11,14L15.5,9.5L17,11L11,17L7.5,13.5Z"/>
          </svg>
          词汇管理
        </a>
        <a href="#stats" class="nav-item" data-section="stats">
          <svg viewBox="0 0 24 24" width="20" height="20">
            <path fill="currentColor" d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
          </svg>
          统计数据
        </a>
      </nav>
    </aside>

    <!-- 主内容区 -->
    <main class="main-content">
      <!-- API 配置 -->
      <section id="api" class="settings-section active">
        <h2>API 配置</h2>
        <p class="section-desc">配置用于翻译的 AI 服务 API</p>

        <div class="form-group">
          <label>预设服务</label>
          <div class="preset-buttons">
            <button class="preset-btn" data-preset="openai">OpenAI</button>
            <button class="preset-btn" data-preset="deepseek">DeepSeek</button>
            <button class="preset-btn" data-preset="moonshot">Moonshot</button>
            <button class="preset-btn" data-preset="groq">Groq</button>
            <button class="preset-btn" data-preset="ollama">Ollama</button>
          </div>
        </div>

        <div class="form-group">
          <label for="apiEndpoint">API 端点</label>
          <input type="url" id="apiEndpoint" placeholder="https://api.example.com/v1/chat/completions">
        </div>

        <div class="form-group">
          <label for="apiKey">API 密钥</label>
          <div class="input-with-toggle">
            <input type="password" id="apiKey" placeholder="sk-xxxxx">
            <button type="button" class="toggle-visibility" id="toggleApiKey">
              <svg viewBox="0 0 24 24" width="20" height="20">
                <path fill="currentColor" d="M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"/>
              </svg>
            </button>
          </div>
        </div>

        <div class="form-group">
          <label for="modelName">模型名称</label>
          <input type="text" id="modelName" placeholder="gpt-4o-mini">
        </div>

        <div class="form-actions">
          <button class="btn btn-secondary" id="testConnectionBtn">
            <svg viewBox="0 0 24 24" width="18" height="18">
              <path fill="currentColor" d="M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M11,16.5L18,9.5L16.59,8.09L11,13.67L7.91,10.59L6.5,12L11,16.5Z"/>
            </svg>
            测试连接
          </button>
          <span class="test-result" id="testResult"></span>
        </div>
      </section>

      <!-- 学习偏好 -->
      <section id="learning" class="settings-section">
        <h2>学习偏好</h2>
        <p class="section-desc">设置你的语言学习目标和难度</p>

        <div class="form-row">
          <div class="form-group">
            <label for="nativeLanguage">母语语言</label>
            <select id="nativeLanguage">
              <option value="zh-CN">简体中文</option>
              <option value="zh-TW">繁体中文</option>
              <option value="en">English</option>
              <option value="ja">日本語</option>
              <option value="ko">한국어</option>
            </select>
          </div>
          <div class="form-group">
            <label for="targetLanguage">学习语言</label>
            <select id="targetLanguage">
              <option value="en">English</option>
              <option value="zh-CN">简体中文</option>
              <option value="zh-TW">繁体中文</option>
              <option value="ja">日本語</option>
              <option value="ko">한국어</option>
              <option value="fr">Français</option>
              <option value="de">Deutsch</option>
              <option value="es">Español</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label for="difficultyLevel">难度等级 (CEFR)</label>
          <div class="difficulty-selector">
            <input type="range" id="difficultyLevel" min="0" max="5" value="2">
            <div class="difficulty-labels">
              <span>A1</span>
              <span>A2</span>
              <span>B1</span>
              <span>B2</span>
              <span>C1</span>
              <span>C2</span>
            </div>
          </div>
          <p class="help-text">选择 <strong id="selectedDifficulty">B1</strong> 等级，将显示该等级及以上难度的词汇</p>
          <div class="retest-vocab-container">
            <button type="button" class="retest-vocab-btn" id="retestVocabBtn">
              <div class="retest-icon">
                <svg viewBox="0 0 24 24" width="20" height="20">
                  <path fill="currentColor" d="M12,3A9,9 0 0,0 3,12A9,9 0 0,0 12,21A9,9 0 0,0 21,12H19C19,15.86 15.86,19 12,19A7,7 0 0,1 5,12A7,7 0 0,1 12,5C13.12,5 14.19,5.26 15.14,5.71L13,7.88V7.88L15.58,10.46L19.59,6.44L16.17,3.03L14,5.21C13.07,4.76 12.06,4.5 11,4.5C10.68,4.5 10.36,4.53 10.05,4.58C10.03,4.39 10,4.19 10,4A2,2 0 0,1 12,2A2,2 0 0,1 14,4C14,4.19 13.97,4.39 13.95,4.58C17.95,5.5 21,9 21,13H23A11,11 0 0,0 12,2A11,11 0 0,0 1,13A11,11 0 0,0 12,24A11,11 0 0,0 23,13C23,12.68 23,12.35 22.96,12.03C22.97,12.02 23,12 23,12H21A9,9 0 0,1 12,21Z"/>
                </svg>
              </div>
              <div class="retest-content">
                <span class="retest-title">重新测试词汇量</span>
                <span class="retest-desc">基于 5000+ 真实单词，重新评估您的 CEFR 等级</span>
              </div>
              <div class="retest-arrow">
                <svg viewBox="0 0 24 24" width="20" height="20">
                  <path fill="currentColor" d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"/>
                </svg>
              </div>
            </button>
          </div>
        </div>

        <div class="form-group">
          <label>替换强度</label>
          <div class="intensity-selector">
            <label class="intensity-option">
              <input type="radio" name="intensity" value="low">
              <span class="intensity-card">
                <span class="intensity-icon">📖</span>
                <span class="intensity-name">较少</span>
                <span class="intensity-desc">每段 4 词</span>
              </span>
            </label>
            <label class="intensity-option">
              <input type="radio" name="intensity" value="medium" checked>
              <span class="intensity-card">
                <span class="intensity-icon">📚</span>
                <span class="intensity-name">适中</span>
                <span class="intensity-desc">每段 8 词</span>
              </span>
            </label>
            <label class="intensity-option">
              <input type="radio" name="intensity" value="high">
              <span class="intensity-card">
                <span class="intensity-icon">🎓</span>
                <span class="intensity-name">较多</span>
                <span class="intensity-desc">每段 14 词</span>
              </span>
            </label>
          </div>
        </div>
      </section>

      <!-- 行为设置 -->
      <section id="behavior" class="settings-section">
        <h2>行为设置</h2>
        <p class="section-desc">控制插件的自动化行为</p>

        <div class="toggle-group">
          <div class="toggle-item">
            <div class="toggle-info">
              <span class="toggle-title">自动处理新页面</span>
              <span class="toggle-desc">打开新页面时自动进行词汇替换</span>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="autoProcess">
              <span class="toggle-slider"></span>
            </label>
          </div>

          <div class="toggle-item">
            <div class="toggle-info">
              <span class="toggle-title">显示音标</span>
              <span class="toggle-desc">在悬停提示中显示学习语言的音标</span>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="showPhonetic" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>

          <div class="toggle-item">
            <div class="toggle-info">
              <span class="toggle-title">左键单击发音</span>
              <span class="toggle-desc">左键点击已替换的单词时直接发音</span>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="allowLeftClickPronunciation" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>

          <div class="toggle-item">
            <div class="toggle-info">
              <span class="toggle-title">标记已学会时恢复同词</span>
              <span class="toggle-desc">标记一个单词已学会时，恢复页面上所有相同单词</span>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="restoreAllSameWordsOnLearned" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>

        <div class="form-group">
          <label for="pronunciationProvider">发音来源</label>
          <p class="help-text">点击“发音”按钮时使用的音频来源（有道仅在学习语言为英语时生效；Google 在国内直连通常会超时）</p>
          <select id="pronunciationProvider">
            <option value="wiktionary">Wiktionary</option>
            <option value="youdao">有道翻译(英语)</option>
            <option value="google">Google 翻译 TTS(多语言)</option>
          </select>
        </div>

        <div class="form-group" id="youdaoPronunciationSettings" hidden>
          <label for="youdaoPronunciationType">有道口音</label>
          <p class="help-text">接口：https://dict.youdao.com/dictvoice?audio={word}&type={1/2}（type=1 英音，type=2 美音）</p>
          <select id="youdaoPronunciationType">
            <option value="1">英音 (type=1)</option>
            <option value="2">美音 (type=2)</option>
          </select>
        </div>

        <div class="form-group">
          <label>翻译显示样式</label>
          <p class="help-text">选择翻译词汇在页面上的显示方式</p>
          <div class="style-selector">
            <label class="style-option">
              <input type="radio" name="translationStyle" value="translation-original" checked>
              <span class="style-card">
                <span class="style-preview">译文(原文)</span>
                <span class="style-desc">默认样式</span>
              </span>
            </label>
            <label class="style-option">
              <input type="radio" name="translationStyle" value="translation-only">
              <span class="style-card">
                <span class="style-preview">译文</span>
                <span class="style-desc">仅显示译文，悬停查看原文</span>
              </span>
            </label>
            <label class="style-option">
              <input type="radio" name="translationStyle" value="original-translation">
              <span class="style-card">
                <span class="style-preview">原文(译文)</span>
                <span class="style-desc">原文在前，译文在后</span>
              </span>
            </label>
          </div>
        </div>
      </section>

      <!-- 主题设置 -->
      <section id="theme" class="settings-section">
        <h2>主题设置</h2>
        <p class="section-desc">自定义 Sapling 的品牌色与界面配色</p>

        <div class="theme-grid">
          <div class="theme-card">
            <label for="themeBrand">主品牌色 (Sprout)</label>
            <div class="theme-input-row">
              <input type="color" id="themeBrand" value="#81C784">
              <input type="text" id="themeBrandText" class="theme-hex-input" value="#81C784" maxlength="7">
            </div>
          </div>

          <div class="theme-card">
            <label for="themeBackground">核心背景色 (Deep Earth)</label>
            <div class="theme-input-row">
              <input type="color" id="themeBackground" value="#1B1612">
              <input type="text" id="themeBackgroundText" class="theme-hex-input" value="#1B1612" maxlength="7">
            </div>
          </div>

          <div class="theme-card">
            <label for="themeCard">容器/卡片背景</label>
            <div class="theme-input-row">
              <input type="color" id="themeCard" value="#26201A">
              <input type="text" id="themeCardText" class="theme-hex-input" value="#26201A" maxlength="7">
            </div>
          </div>

          <div class="theme-card">
            <label for="themeHighlight">替换词强调色</label>
            <div class="theme-input-row">
              <input type="color" id="themeHighlight" value="#A5D6A7">
              <input type="text" id="themeHighlightText" class="theme-hex-input" value="#A5D6A7" maxlength="7">
            </div>
          </div>

          <div class="theme-card">
            <label for="themeUnderline">替换词下划线</label>
            <div class="theme-input-row">
              <input type="color" id="themeUnderline" value="#4E342E">
              <input type="text" id="themeUnderlineText" class="theme-hex-input" value="#4E342E" maxlength="7">
            </div>
          </div>

          <div class="theme-card">
            <label for="themeText">文字主色 (Mist)</label>
            <div class="theme-input-row">
              <input type="color" id="themeText" value="#D7CCC8">
              <input type="text" id="themeTextText" class="theme-hex-input" value="#D7CCC8" maxlength="7">
            </div>
          </div>
        </div>

        <div class="form-actions">
          <button class="btn btn-secondary" id="themeResetBtn" type="button">恢复默认主题</button>
        </div>
      </section>

      <!-- 高级设置 -->
      <section id="advanced" class="settings-section">
        <h2>高级设置</h2>
        <p class="section-desc">控制处理性能与资源占用</p>

        <div class="form-group">
          <label for="concurrencyLimit">并发限制</label>
          <p class="help-text">同时处理的段落数量上限（也会影响 API 请求并发）。默认：3</p>
          <input type="number" id="concurrencyLimit" min="1" max="20" step="1" value="3">
        </div>

      </section>

      <!-- 站点规则 -->
      <section id="sites" class="settings-section">
        <h2>站点规则</h2>
        <p class="section-desc">设置哪些站点需要或不需要处理</p>

        <div class="form-group">
          <label for="blacklistInput">黑名单（永不处理）</label>
          <p class="help-text">这些站点将不会进行任何处理，每行一个域名</p>
          <textarea id="blacklistInput" placeholder="example.com
another-site.org"></textarea>
        </div>

        <div class="form-group">
          <label for="whitelistInput">白名单（始终处理）</label>
          <p class="help-text">即使关闭自动处理，这些站点也会被处理，每行一个域名</p>
          <textarea id="whitelistInput" placeholder="learning-site.com"></textarea>
        </div>
      </section>

      <!-- 词汇管理 -->
      <section id="words" class="settings-section">
        <h2>词汇管理</h2>
        <p class="section-desc">管理已学会和需记忆的词汇</p>

        <div class="word-tabs">
          <button class="word-tab active" data-tab="learned">已学会 (<span id="learnedTabCount">0</span>)</button>
          <button class="word-tab" data-tab="memorize">需记忆 (<span id="memorizeTabCount">0</span>)</button>
          <button class="word-tab" data-tab="cached">已缓存 (<span id="cachedTabCount">0</span>)</button>
        </div>

        <!-- 已学会页面的搜索和筛选 -->
        <div class="word-filters hidden" id="learnedFilters" data-tab="learned">
          <div class="search-box">
            <input type="text" id="learnedSearchInput" placeholder="搜索单词或翻译..." class="search-input">
            <svg viewBox="0 0 24 24" width="18" height="18" class="search-icon">
              <path fill="currentColor" d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"/>
            </svg>
          </div>
          <div class="filter-box">
            <label>难度筛选：</label>
            <div class="difficulty-filters">
              <button class="difficulty-filter-btn active" data-difficulty="all" data-tab="learned">全部</button>
              <button class="difficulty-filter-btn" data-difficulty="A1" data-tab="learned">A1</button>
              <button class="difficulty-filter-btn" data-difficulty="A2" data-tab="learned">A2</button>
              <button class="difficulty-filter-btn" data-difficulty="B1" data-tab="learned">B1</button>
              <button class="difficulty-filter-btn" data-difficulty="B2" data-tab="learned">B2</button>
              <button class="difficulty-filter-btn" data-difficulty="C1" data-tab="learned">C1</button>
              <button class="difficulty-filter-btn" data-difficulty="C2" data-tab="learned">C2</button>
            </div>
          </div>
          <div class="word-actions">
            <button class="btn btn-danger" id="clearLearnedBtn">清空已学会</button>
          </div>
        </div>

        <!-- 需记忆页面的搜索和筛选 -->
        <div class="word-filters hidden" id="memorizeFilters" data-tab="memorize">
          <div class="search-box">
            <input type="text" id="memorizeSearchInput" placeholder="搜索单词或翻译..." class="search-input">
            <svg viewBox="0 0 24 24" width="18" height="18" class="search-icon">
              <path fill="currentColor" d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"/>
            </svg>
          </div>
          <div class="filter-box">
            <label>难度筛选：</label>
            <div class="difficulty-filters">
              <button class="difficulty-filter-btn active" data-difficulty="all" data-tab="memorize">全部</button>
              <button class="difficulty-filter-btn" data-difficulty="A1" data-tab="memorize">A1</button>
              <button class="difficulty-filter-btn" data-difficulty="A2" data-tab="memorize">A2</button>
              <button class="difficulty-filter-btn" data-difficulty="B1" data-tab="memorize">B1</button>
              <button class="difficulty-filter-btn" data-difficulty="B2" data-tab="memorize">B2</button>
              <button class="difficulty-filter-btn" data-difficulty="C1" data-tab="memorize">C1</button>
              <button class="difficulty-filter-btn" data-difficulty="C2" data-tab="memorize">C2</button>
            </div>
          </div>
          <div class="word-actions">
            <button class="btn btn-danger" id="clearMemorizeBtn">清空需记忆</button>
          </div>
        </div>

        <!-- 已缓存页面的搜索和筛选 -->
        <div class="word-filters hidden" id="cachedFilters" data-tab="cached">
          <div class="search-box">
            <input type="text" id="cachedSearchInput" placeholder="搜索单词或翻译..." class="search-input">
            <svg viewBox="0 0 24 24" width="18" height="18" class="search-icon">
              <path fill="currentColor" d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"/>
            </svg>
          </div>
          <div class="filter-box">
            <label>难度筛选：</label>
            <div class="difficulty-filters">
              <button class="difficulty-filter-btn active" data-difficulty="all" data-tab="cached">全部</button>
              <button class="difficulty-filter-btn" data-difficulty="A1" data-tab="cached">A1</button>
              <button class="difficulty-filter-btn" data-difficulty="A2" data-tab="cached">A2</button>
              <button class="difficulty-filter-btn" data-difficulty="B1" data-tab="cached">B1</button>
              <button class="difficulty-filter-btn" data-difficulty="B2" data-tab="cached">B2</button>
              <button class="difficulty-filter-btn" data-difficulty="C1" data-tab="cached">C1</button>
              <button class="difficulty-filter-btn" data-difficulty="C2" data-tab="cached">C2</button>
            </div>
          </div>
          <div class="word-actions">
            <button class="btn btn-danger" id="clearCacheBtn">清空缓存</button>
          </div>
        </div>

        <div class="word-list-container">
          <div class="word-list" id="learnedList" data-tab="learned"></div>
          <div class="word-list hidden" id="memorizeList" data-tab="memorize"></div>
          <div class="word-list hidden" id="cachedList" data-tab="cached"></div>
        </div>
      </section>

      <!-- 统计数据 -->
      <section id="stats" class="settings-section">
        <h2>统计数据</h2>
        <p class="section-desc">查看你的学习进度</p>

        <div class="stats-overview">
          <div class="stat-box">
            <div class="stat-number" id="statTotalWords">0</div>
            <div class="stat-label">累计接触词汇</div>
          </div>
          <div class="stat-box">
            <div class="stat-number" id="statTodayWords">0</div>
            <div class="stat-label">今日接触词汇</div>
          </div>
          <div class="stat-box">
            <div class="stat-number" id="statLearnedWords">0</div>
            <div class="stat-label">已学会词汇</div>
          </div>
          <div class="stat-box">
            <div class="stat-number" id="statMemorizeWords">0</div>
            <div class="stat-label">需记忆词汇</div>
          </div>
        </div>

        <div class="cache-overview">
          <h3>缓存状态</h3>
          <div class="cache-bar">
            <div class="cache-progress" id="cacheProgress"></div>
          </div>
          <div class="cache-info">
            <span>已缓存: <strong id="statCacheSize">0</strong> / <strong id="statCacheMaxSize">2048</strong></span>
            <span>命中率: <strong id="statHitRate">0%</strong></span>
          </div>

          <div class="form-group">
            <label for="cacheMaxSize">缓存容量上限</label>
            <div class="difficulty-selector cache-size-selector">
              <div class="cache-size-controls">
                <div class="cache-size-range">
                  <input type="range" id="cacheMaxSize" min="2048" max="8192" value="2048" step="1024" list="cacheMaxSizeTicks">
                  <datalist id="cacheMaxSizeTicks">
                    <option value="2048" label="2048"></option>
                    <option value="3072" label="3072"></option>
                    <option value="4096" label="4096"></option>
                    <option value="5120" label="5120"></option>
                    <option value="6144" label="6144"></option>
                    <option value="7168" label="7168"></option>
                    <option value="8192" label="8192"></option>
                  </datalist>
                  <div class="cache-size-labels">
                    <span>2048</span>
                    <span>3072</span>
                    <span>4096</span>
                    <span>5120</span>
                    <span>6144</span>
                    <span>7168</span>
                    <span>8192</span>
                  </div>
                </div>
                <input type="number" id="cacheMaxSizeInput" min="2048" max="8192" step="1024" value="2048">
              </div>
            </div>
            <p class="help-text">当前：<strong id="cacheMaxSizeValue">2048</strong>（调小会自动删除最旧缓存）</p>
          </div>
        </div>

        <div class="stats-actions">
          <button class="btn btn-secondary" id="resetTodayBtn">重置今日统计</button>
          <button class="btn btn-danger" id="resetAllBtn">重置所有数据</button>
        </div>
      </section>

      <!-- 设置页面支持自动保存，也提供手动保存按钮 -->
    </main>
  </div>

  <button class="btn btn-primary manual-save-btn" id="manualSaveBtn" type="button" title="保存设置">
    手动保存
  </button>

  <div class="options-toast-container" id="optionsToastContainer" aria-live="polite" aria-atomic="true"></div>

  <script type="module" src="js/options.js"></script>
</body>
</html>
